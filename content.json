{"pages":[{"title":"404","text":"var QZONE = window.QZONE || {}; function imagezoom(imgobj, box_w, box_h) { var src_w = imgobj.width; var src_h = imgobj.height; var r1 = src_w / src_h, r2 = box_w / box_h; var dst_w, dst_h; if (r1 > r2) { dst_w = box_w; dst_h = Math.round(dst_w / src_w * src_h); } else { if (r1 < r2) { dst_h = box_h; dst_w = Math.round(dst_h / src_h * src_w); } else { dst_w = box_w; dst_h = box_h; } } imgobj.style.marginLeft = (box_w - dst_w) / 2 + \"px\"; imgobj.style.marginTop = (box_h - dst_h) / 2 + \"px\"; imgobj.style.width = dst_w + \"px\"; imgobj.style.height = dst_h + \"px\"; imgobj.style.opacity = 1; } (function(_w, _d) { var ha = _d.head || _d.getElementsByTagName(\"head\")[0]; var $scope = {}; var current; var tmnow; var chId; var homePageUrl, homePageName; var scs = document.getElementsByTagName(\"script\"); if (location.href.indexOf(\"fm.qq.com\") > -1 || location.href.indexOf(\"fm.qzone.qq.com\") > -1) { homePageName = \"\\u8fd4\\u56de\\u4f01\\u9e45FM\"; homePageUrl = \"http://fm.qq.com\"; } else { if (location.href.indexOf(\"qzone.qq.com\") > -1) { homePageName = \"\\u8fd4\\u56de\\u6211\\u7684\\u7a7a\\u95f4\"; homePageUrl = \"http://qzone.qq.com\"; } else { homePageName = \"\\u8fd4\\u56de\\u817e\\u8baf\\u7f51\"; homePageUrl = \"http://www.qq.com\"; } } for (var i = 0;i < scs.length;i++) { if (scs[i].src.indexOf(\"404/search_children.js\") > -1) { if (scs[i].getAttribute(\"homePageUrl\")) { homePageUrl = scs[i].getAttribute(\"homePageUrl\"); } if (scs[i].getAttribute(\"homePageName\")) { homePageName = scs[i].getAttribute(\"homePageName\"); } break; } } $scope.rettext = homePageName; $scope.retlink = homePageUrl; function getData(srcUrl, callback) { var sc = _d.createElement(\"script\"); function orc() { if (sc.readyState === \"loaded\") { setTimeout(function() { callback && callback(); }, 0); } } if (sc.addEventListener) { if (callback) { sc.addEventListener(\"load\", callback, false); } } else { sc.attachEvent(\"onreadystatechange\", orc); } ha && ha.appendChild(sc); sc.src = srcUrl; } function resolveData(d) { var tid, len, ddata = [], tdata; if (\"object\" == typeof d && (d.data && (len = d.data.length))) { for (var i = 0;i < len;i++) { var expire = d.data[i].expire; d.data[i]._id = new Date * Math.random() * Math.random() * 1E7; if (expire && tmnow * 1E3 < Date.parse(expire.replace(/\\s[\\s\\S]*$/, \"\").replace(/\\-/g, \"/\"))) { var _c = d.data[i].city, _p = d.data[i].province; if (_c && city) { if ((\"_\" + _c + \"_\").indexOf(\"_\" + city + \"_\") > -1) { ddata.push(d.data[i]); continue; } } if (_p && province) { if ((\"_\" + _p + \"_\").indexOf(\"_\" + province + \"_\") > -1) { ddata.push(d.data[i]); } } } } tid = Math.floor(Math.random() * (ddata.length || len)); tdata = (ddata.length ? ddata : d.data)[chId = tid]; if (_w.foundjsondata) { tdata.ta = tdata.sex.indexOf(\"\\u5973\") > -1 ? \"\\u5979\" : \"\\u4ed6\"; tdata.name = \"\\u201c7\\u00b718\\u7279\\u5927\\u62d0\\u5356\\u5a74\\u513f\\u6848\\u201d\\u544a\\u7834\\uff0c\\u88ab\\u89e3\\u6551\\u768415\\u540d\\u5b69\\u5b50\\u4e2d\\uff0c2\\u4eba\\u7531\\u4eb2\\u751f\\u7236\\u6bcd\\u9886\\u56de\\uff0c\\u4ecd\\u670913\\u540d\\u5b69\\u5b50\\u672a\\u627e\\u5230\\u4eb2\\u751f\\u7236\\u6bcd\\uff0c\\u88ab\\u5b89\\u7f6e\\u5728\\u60e0\\u5dde\\u5e02\\u793e\\u4f1a\\u798f\\u5229\\u9662\\uff0c\" + tdata.ta + \"\\u662f\\u5176\\u4e2d\\u4e4b\\u4e00\\u3002\"; tdata.url = tdata.url.replace(/#p=(\\d{1,2})/, function(a, n) { return \"#p=\" + (+n + 1); }); return format(tmpl2, tdata); } if (!tdata.ext1) { tdata.ext1 = \"\\u4f46\\u6211\\u4eec\\u53ef\\u4ee5\\u4e00\\u8d77\\u5bfb\\u627e\\u5931\\u8e2a\\u5b9d\\u8d1d\"; } return tdata; } } function setTopData(tdata) { current = tdata; $scope.topname = tdata.name; $scope.topgender = tdata.sex; $scope.topbirth = tdata.birth_time; $scope.toplostdate = tdata.lost_time; $scope.toplostplace = tdata.lost_place; $scope.toplostdesc = tdata.child_feature; $scope.toplink = tdata.url; $scope.topimg = tdata.child_pic; $scope.topid = tdata._id; document.body.innerHTML = template(\"body\", $scope); } function init(data) { tmnow = data.tm_now * 1E3; var tdata = resolveData(jsondata); $scope.whichin = 0; jsondata.data.splice(chId, 1); $scope.otherdata = [tdata].concat(jsondata.data.slice(0, 5)); setTopData(tdata); } var timeout; window._Callback = function(d) { clearTimeout(timeout); init(d); }; timeout = setTimeout(function() { _Callback({tm_now:(new Date).getTime() / 1E3}); }, 2E3); _w.share = function(target) { var summary = [\"\\u80cc\\u666f\\uff1a\", current.name, \"\\uff0c\\u6027\\u522b\\uff1a\", current.sex, \"\\uff0c\\u51fa\\u751f\\u65f6\\u95f4\\uff1a\", current.birth_time, \"\\uff0c\\u5931\\u8e2a\\u65f6\\u95f4\\uff1a\", current.lost_time, \"\\uff0c\\u7279\\u5f81\\u63cf\\u8ff0\\uff1a\", current.child_feature].join(\"\"); if (summary) { summary = \"#\\u5bfb\\u627e\\u5931\\u8e2a\\u7684\\u5b9d\\u8d1d#\" + summary; } var stitle = \"\\u5931\\u8e2a\\u7684\\u5b9d\\u8d1d\\u8be6\\u60c5\"; var desc = \"\\u5931\\u8e2a\\u7684\\u5b9d\\u8d1d\\u8981\\u56de\\u5bb6\\uff0c\\u5feb\\u6765\\u53c2\\u4e0e\\u7231\\u5fc3\\u7684\\u4f20\\u9012\\u5427\\uff01\"; var encode = encodeURIComponent; var opts = {\"surl\":\"http://qzone.qq.com/gy/404/\" + current.id + \"/lostchild.html\", \"site\":\"QQ\\u7a7a\\u95f4\", \"summary\":summary || \"#\\u5b9d\\u8d1d\\u56de\\u5bb6#\\u817e\\u8baf\\u5fd7\\u613f\\u8005\\u7528\\u6280\\u672f\\u70b9\\u4eae\\u516c\\u76ca\\uff0c\\u8ba9\\u6211\\u4eec\\u4e00\\u8d77\\u5bfb\\u627e\\u8d70\\u5931\\u7684\\u513f\\u7ae5\\u5427\\uff01\", \"stitle\":stitle, \"pics\":current.child_pic, \"desc\":desc, \"origin_url\":current.url}; var surl = opts.surl || \"http://www.qq.com/404/\", summary = opts.summary || \"\\u8fd9\\u4e2a\\u662f\\u5206\\u4eab\\u7684\\u5185\\u5bb9\", stitle = opts.stitle || \"\\u8fd9\\u4e2a\\u662f\\u5206\\u4eab\\u7684\\u6807\\u9898\", pics = opts.pics || \"http://qzonestyle.gtimg.cn/qzone_v6/act/img/20120422_qzone_7_years/pop_up/icon-pop-seven-years.png\", site = opts.site || \"\\u8fd9\\u4e2a\\u662f\\u5206\\u4eab\\u94fe\\u63a5\\u7684\\u6587\\u5b57\", desc = opts.desc || \"\\u5931\\u8e2a\\u7684\\u5b9d\\u8d1d\\u8981\\u56de\\u5bb6\\uff0c\\u5feb\\u6765\\u53c2\\u4e0e\\u7231\\u5fc3\\u7684\\u4f20\\u9012\\u5427\\uff01\", origin_url = opts.origin_url || \"http://www.qq.com/404/\"; var shareList = {weibo:{method:function(evt) { var w = \"http://v.t.qq.com/share/share.php\", q = [\"?site=\", encode(surl + \"#via=share_t_weib\"), \"&title=\", encode(summary), \"&pic=\", encode(pics), \"&url=\", encode(surl)].join(\"\"), p = [w, q].join(\"\"); openit(p, \"weibo\", \"width=700, height=680, top=0, left=0, toolbar=no, menubar=no, scrollbars=no, location=yes, resizable=no, status=no\"); }}, qzone:{method:function(evt) { var buff = [], ps = {url:surl + \"#via=404-qzoneshare\", desc:desc || \"\\u5931\\u8e2a\\u7684\\u5b9d\\u8d1d\\u8981\\u56de\\u5bb6\\uff0c\\u5feb\\u6765\\u53c2\\u4e0e\\u7231\\u5fc3\\u7684\\u4f20\\u9012\\u5427\\uff01\", summary:summary, title:stitle, pics:pics, site:site}; for (var k in ps) { buff.push(k + \"=\" + encode(ps[k] || \"\")); } var w = \"http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?\" + buff.join(\"&\"), q = [\"#via=share_t_qzone\", \"&title=\", encode(summary), \"&pic=\", encode(pics), \"&url=\", encode(surl)].join(\"\"), p = [w, q].join(\"\"); openit(p, \"qzone\", \"width=700, height=680, top=0, left=0, toolbar=no, menubar=no, scrollbars=no, location=yes, resizable=no, status=no\"); }}, sina:{method:function() { var w = \"http://v.t.sina.com.cn/share/share.php\", q = [\"?url=\", encode(surl + \"#via=share_x_weib\"), \"&title=\", encode(summary), \"&source=\", \"&sourceUrl=\", surl, \"&content=utf-8\", \"&pic=\", encode(pics)].join(\"\"), p = [w, q].join(\"\"); openit(p, \"sina\", \"toolbar=0,status=0,resizable=1,width=440,height=430\"); }}, kaixin:{method:function() { var n = \"http://www.kaixin001.com/repaste/bshare.php?rurl=\" + encode(surl + \"#via=share_kaixin\") + \"&rcontent=&rtitle=\" + encode(summary); openit(n, \"kaixin\", \"toolbar=0,status=0,resizable=1,width=600,height=360\"); }}, renren:{method:function() { var n = \"http://www.connect.renren.com/share/sharer?title=\" + encode(summary) + \"&url=\" + encode(surl + \"#via=share_renren\"), p = window.open(n, \"rr\", \"toolbar=0,status=0,resizable=1,width=510,height=300\"); if (p) { p.focus(); } }}, weixin:{method:function() { var n = \"http://qzone.qq.com/gy/404/page/qrcode.html?url=\" + encode(origin_url + \"#via=share_weixin\"), p = window.open(n, \"rr\", \"toolbar=0,status=0,resizable=1,width=620,height=430\"); if (p) { p.focus(); } }}}; var openit = function(u, n, p) { function o() { var z; if (!(z = window.open(u, n, p))) { location.href = u; } else { z.focus(); } } o(); }; shareList[target] && shareList[target].method(); }; _w.toThis = function(id) { for (var i = 0;i < $scope.otherdata.length;i++) { if ($scope.otherdata[i]._id == id) { setTopData($scope.otherdata[i]); break; } } return false; }; var meta = document.createElement(\"meta\"); meta.name = \"viewport\"; meta.content = \"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no\"; ha.appendChild(meta); (function registerStyle() { var link = document.createElement(\"link\"); link.rel = \"stylesheet\"; link.type = \"text/css\"; link.href = \"https://qzone.qq.com/gy/404/style/404style.css\"; ha.appendChild(link); })(); (function initStat() { var qqDomainNameRE = /\\.qq\\.com$/i, qzoneDomainNameRE = /\\bqzone\\.qq\\.com$/i, qzsDomainNameRE = /\\bqzonestyle\\.gtimg\\.cn$/i; function cb() { var url = location.host; var src = \"\"; if (qzoneDomainNameRE.test(url)) { src = \"new404.qzone\"; } else { if (qqDomainNameRE.test(url)) { src = \"new404.qq\"; } else { if (qzsDomainNameRE.test(url)) { src = \"new404.qzonestyle\"; } else { src = url.replace(\".\", \"_\"); } } } _w.TCISD && (_w.TCISD.pv && _w.TCISD.pv(\"hat.qzone.qq.com\", \"/gy/lostchild/\" + src)); } getData(\"https://qzonestyle.gtimg.cn/ac/qzfl/stat.js\", cb); })(); })(window, document); !function() { function a(a, b) { return(/string|function/.test(typeof b) ? h : g)(a, b); } function b(a, c) { return \"string\" != typeof a && (c = typeof a, \"number\" === c ? a += \"\" : a = \"function\" === c ? b(a.call(a)) : \"\"), a; } function c(a) { return l[a]; } function d(a) { return b(a).replace(/&(?![\\w#]+;)|[\"']/g, c); } function e(a, b) { if (m(a)) { for (var c = 0, d = a.length;d > c;c++) { b.call(a, a[c], c, a); } } else { for (c in a) { b.call(a, a[c], c); } } } function f(a, b) { var c = /(\\/)[^/]+\\1\\.\\.\\1/, d = (\"./\" + a).replace(/[^/]+$/, \"\"), e = d + b; for (e = e.replace(/\\/\\.\\//g, \"/\");e.match(c);) { e = e.replace(c, \"/\"); } return e; } function g(b, c) { var d = a.get(b) || i({filename:b, name:\"Render Error\", message:\"Template not found\"}); return c ? d(c) : d; } function h(a, b) { if (\"string\" == typeof b) { var c = b; b = function() { return new k(c); }; } var d = j[a] = function(c) { try { return new b(c, a) + \"\"; } catch (d) { return i(d)(); } }; return d.prototype = b.prototype = n, d.toString = function() { return b + \"\"; }, d; } function i(a) { var b = \"{Template Error}\", c = a.stack || \"\"; if (c) { c = c.split(\"\\n\").slice(0, 2).join(\"\\n\"); } else { for (var d in a) { c += \"\\n\" + a[d] + \"\\n\\n\"; } } return function() { return \"object\" == typeof console && console.error(b + \"\\n\\n\" + c), b; }; } var j = a.cache = {}, k = this.String, l = {\"\":\">\", '\"':\"\"\", \"'\":\"'\", \"&\":\"&\"}, m = Array.isArray || function(a) { return \"[object Array]\" === {}.toString.call(a); }, n = a.utils = {$helpers:{}, $include:function(a, b, c) { return a = f(c, a), g(a, b); }, $string:b, $escape:d, $each:e}, o = a.helpers = n.$helpers; a.get = function(a) { return j[a.replace(/^\\.\\//, \"\")]; }, a.helper = function(a, b) { o[a] = b; }, \"function\" == typeof define ? define(function() { return a; }) : \"undefined\" != typeof exports ? module.exports = a : this.template = a, a(\"body\", function(a) { var b = this, c = (b.$helpers, b.$escape), d = a.retlink, e = a.rettext, f = a.topid, g = a.topimg, h = a.topname, i = a.topgender, j = a.topbirth, l = a.toplostdate, m = a.toplostplace, n = a.toplostdesc, o = a.toplink, p = b.$each, q = a.otherdata, r = (a.otheritem, a.index, \"\"); return r += ' 404\\uff0c\\u60a8\\u8bbf\\u95ee\\u7684\\u9875\\u9762\\u627e\\u4e0d\\u56de\\u6765\\u4e86\\uff0c\\u4f46\\u6211\\u4eec\\u53ef\\u4ee5\\u4e00\\u8d77\\u5e2e\\u4ed6\\u4eec\\u56de\\u5bb6\\uff01 ', r += c(e), r += ' ', r += c(h), r += '(', r += c(i), r += ') \\u51fa\\u751f\\u65e5\\u671f\\uff1a', r += c(j), r += ' \\u5931\\u8e2a\\u65f6\\u95f4\\uff1a', r += c(l), r += ' \\u5931\\u8e2a\\u5730\\u70b9\\uff1a', r += c(m), r += ' \\u5931\\u8e2a\\u4eba\\u7279\\u5f81\\u63cf\\u8ff0\\uff1a', r += c(n), r += ' \\u67e5\\u770b\\u8be6\\u60c5 \\u5206\\u4eab \\u817e\\u8baf\\u5fae\\u535a QQ\\u7a7a\\u95f4 \\u65b0\\u6d6a\\u5fae\\u535a \\u5fae\\u4fe1 ', p(q, function(a) { r += ' '; }), r += \" \", new k(r); }); }();","link":"/404.html"},{"title":"","text":"ä¸ªäººç®€ä»‹ åˆ†äº«å¾ˆå–œæ¬¢çš„è€ç½—çš„ä¸€æ®µè¯ï¼š â€œæ¯ä¸€ä¸ªç”Ÿå‘½æ¥åˆ°ä¸–é—´éƒ½æ³¨å®šæ”¹å˜ä¸–ç•Œï¼Œåˆ«æ— é€‰æ‹©ã€‚è¦ä¹ˆå˜å¾—å¥½ä¸€ç‚¹ï¼Œè¦ä¹ˆå˜å¾—åä¸€ç‚¹ã€‚ä½ å¦‚æœèµ°è¿›ç¤¾ä¼šä¸ºäº†ç”Ÿå­˜ä¸ºäº†ä»€ä¹ˆä¸è¦è„¸çš„ç†ç”±ï¼Œå˜æˆäº†ä¸€ä¸ªæ¶å¿ƒçš„æˆå¹´äººç¤¾ä¼šä¸­çš„ä¸€å‘˜ï¼Œé‚£ä½ å°±æŠŠè¿™ä¸ªä¸–ç•Œå˜å¾—æ¶å¿ƒäº†ä¸€ç‚¹ç‚¹ã€‚å¦‚æœä½ ä¸€ç”Ÿåˆšæ­£ä¸é˜¿ï¼Œå¦‚æœä½ ä¸€ç”Ÿè€¿ç›´ï¼Œæ²¡æœ‰åšä»»ä½•æ¶å¿ƒçš„äº‹æƒ…ï¼Œæ²¡åšå¯¹åˆ«äººæœ‰å®³çš„äº‹æƒ…ï¼Œä¸€è¾ˆå­æ‹¼äº†è€å‘½å‹‰å¼ºæŠŠè‡ªå·±èº«è¾¹çš„å‡ ä¸ªäººç…§é¡¾å¥½äº†ï¼Œæ²¡æœ‰æˆåæ²¡æœ‰å‘è´¢ï¼Œæ²¡æœ‰æˆå°±ä¼Ÿå¤§çš„äº‹ä¸šï¼Œç„¶åè€¿ç€è„–å­ä¸€ç”Ÿæ­£ç›´ï¼Œåˆ°äº†ä¸ƒå…«åå²è€¿ç€è„–å­å»ä¸–äº†ã€‚ä½ è¿™ä¸€ç”Ÿæ˜¯ä¸æ˜¯æ²¡æœ‰æ”¹å˜ä¸–ç•Œï¼Ÿä½ è¿˜æ˜¯æ”¹å˜ä¸–ç•Œäº†ï¼Œä½ æŠŠè¿™ä¸ªä¸–ç•Œå˜å¾—ç¾å¥½äº†ä¸€ç‚¹ç‚¹ã€‚å› ä¸ºä¸–ç•Œä¸Šåˆå¤šäº†ä¸€ä¸ªå¥½äººã€‚â€œ å–„æ¶ç»ˆæœ‰æŠ¥,å¤©é“å¥½è½®å›ã€‚ä¸ä¿¡æŠ¬å¤´çœ‹,è‹å¤©é¥¶è¿‡è°ã€‚æ— è®ºä½•æ—¶ä½•åœ°ï¼Œæˆ‘ä»¬éƒ½è¦ä¿æŒä¸€é¢—ç§¯æä¹è§‚ã€å–„è‰¯æ„Ÿæ©çš„å¿ƒã€‚ä½†è¡Œå¥½äº‹è«é—®å‰ç¨‹ï¼Œæ°¸è¿œå¹´è½»ï¼Œæ°¸è¿œçƒ­å†…ç›ˆçœ¶ï¼Œæ°¸è¿œä¿æŒæ­£èƒ½é‡ã€‚ğŸ’ªğŸ’ªğŸ’ªğŸ’ªğŸ’ªğŸ’ªå†²é¸­ï¼ï¼ï¼ï¼ -&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;ä¸ªäººä¿¡æ¯ï¼šè®¡ç®—æœºç§‘å­¦ä¸æŠ€æœ¯ä¸“ä¸šä»äº‹JAVAåç«¯å¼€å‘ç ç•œä¸€æšåšä¿¡ä»£ç æ”¹å˜ä¸–ç•Œ åšå®¢ä¿¡æ¯ ç½‘ç«™é‡‡ç”¨çš„Icarusä¸»é¢˜ è¿½æ±‚å°½å¯èƒ½çš„ç®€æ´ï¼Œæ¸…æ™°ï¼Œæ˜“ç”¨ã€‚ åœ¨Icarusä¸»é¢˜ä¹‹ä¸Šè¿›è¡Œäº†éƒ¨åˆ†ä¿®æ”¹ã€‚ æ›´æ–°æ—¥å¿—ï¼šâ€“2020.09.20ï¼šicarus4.0é€‚é…â€“2020.01.18ï¼šicarus3.0é€‚é…â€“2019.11.17ï¼šå¢åŠ æ·±è‰²ä¸»é¢˜å¼€å…³â€“2019.10.30ï¼šå»å›¾ï¼Œç²¾ç®€å¡ç‰‡â€“2019.10.22ï¼šæ”¹ç‰ˆéƒ¨åˆ†æ˜¾ç¤ºï¼Œä¼˜åŒ–é€Ÿåº¦â€“2019.10.16ï¼šæ–‡ç« åˆ—è¡¨åŠ ä¸Šè¯„è®ºæ•°æ˜¾ç¤ºâ€“2019.10.13ï¼šæ”¹ç‰ˆè¯„è®ºâ€“2019.09.25ï¼šå›¾ç‰‡ã€èµ„æºæ¥å…¥CDNå…è´¹jsDelivrã€æ–‡ç« åŠ å…¥ç½®é¡¶â€“2019.09.19ï¼šå¼€æºåšå®¢ä»£ç â€“2019.09.19ï¼šä¿®æ”¹å¸ƒå±€ï¼Œæ‹‰ä¼¸å¸ƒå±€ï¼Œæ›´å®½çš„å±•ç¤ºâ€“2019.09.18ï¼šä¿®æ”¹å‹é“¾uiä¸ºä¸€è¡Œä¸‰ä¸ªï¼Œå¹¶é€‚é…ç§»åŠ¨ç«¯ï¼Œæš—é»‘æ¨¡å¼æ–‡ç« å¢åŠ è¯„è®ºé“¾æ¥ï¼Œå¢åŠ ç•™è¨€é“¾æ¥â€“2019.09.14ï¼šå¢åŠ ç²¾ç®€nextä¸»é¢˜â€“2019.09.14ï¼šåˆ©ç”¨ä¸­ç§‹èŠ‚æ”¾å‡ï¼Œé‡åšäº†é¦–é¡µçš„çƒ­é—¨æ¨èã€åŠ ä¸ªwidgetæœ€æ–°è¯„è®ºæ¡†ã€å½’æ¡£é¡µåŠ å…¥æ–‡ç« è´¡çŒ®æ¦‚è§ˆé¢æ¿ æœ¬ç«™æ¨èç´¢å¼• åšå®¢ä¸»é¢˜ç›¸å…³ github Issue ä½œä¸ºåšå®¢å¾®å‹æ•°æ®åº“çš„åº”ç”¨ github pageç½‘ç«™cdnä¼˜åŒ–åŠ é€Ÿ åšå®¢æºç åˆ†äº« åšå®¢æ¢è‚¤çš„ä¸€ç§å®ç°æ–¹å¼æ€è·¯ åšå®¢ä¸­gitalkæœ€æ–°è¯„è®ºçš„è·å– åšå®¢å›¾ç‰‡ä¸Šä¼ picgoå·¥å…·githubå›¾ä¼ ä½¿ç”¨ å®‰è£…ã€éƒ¨åˆ†é…ç½®icarusä¸»é¢˜ä¸­æ–‡ç‰ˆ æŠ€æœ¯çŸ¥è¯†ç‚¹ Javaå¹¶å‘çŸ¥è¯†ç‚¹ æ³•å¾‹æ³•è§„ æ³•å¾‹æ³•è§„æ•°æ®åº“ ä¸­åäººæ°‘å…±å’Œå›½å›½æ——æ³• ä¸­åäººæ°‘å…±å’Œå›½å®ªæ³• ä¸­åäººæ°‘å…±å’Œå›½æ¶ˆè´¹è€…æƒç›Šä¿æŠ¤æ³• ä¸­åäººæ°‘å…±å’Œå›½åˆ‘äº‹è¯‰è®¼æ³• ä¸­åäººæ°‘å…±å’Œå›½å©šå§»æ³• ä¸­åäººåå…±å’Œå›½ç½‘ç»œå®‰å…¨æ³• ä¸­åäººæ°‘å…±å’Œå›½åŠ³åŠ¨æ³• å…¶ä»– ç½‘æ˜“äº‘éŸ³ä¹æ­Œå•åˆ†äº« è®¡åˆ’2020è®¡åˆ’ 2019.12.31 2020-GOALS è·‘ä¸¤ä¸‰åœºé©¬æ‹‰æ¾ 2019è®¡åˆ’ 2018.12.31/21:59:00-&gt;æ›´æ–°äº2019.12.31 2019-GOALS è´­ä¹°çš„ä¸“ä¸šä¹¦ç±è‡³å°‘çœ‹å®Œä¸€éï¼ˆå¹¶å‘ã€é‡æ„ã€è®¾è®¡æ¨¡å¼â€¦ï¼‰-&gt; 95% é¢å¤–ï¼š è¿½äº†å¾ˆå¤šå‰§ æ€»ç»“ï¼š æœ‰ä¼˜ç‚¹æœ‰ç¼ºç‚¹ï¼Œæ²¡åšæŒä¸‹æ¥çš„è¿˜æ˜¯å¤ªå¤šï¼Œè¿½äº†å¤ªå¤šå‰§ã€‚ä»¥åå¤šå­¦ä¹ ï¼Œå¤šæ€è€ƒï¼ æ—¶é—´è½´è®°å½•","link":"/about/index.html"},{"title":"","text":"ğŸˆğŸˆå¾®ç¬‘å¢™ğŸˆğŸˆ å½­å°è‹’ å”è‰ºæ˜• æä¸€æ¡ gakki å›¾ç‰‡æœé›†äºäº’è”ç½‘ï¼Œä¾µæƒè¯·ç•™è¨€ï¼Œé©¬ä¸Šå¤„ç†ğŸ˜Šã€‚","link":"/album/index.html"},{"title":"","text":"ç”³è¯·å‹é“¾é¡»çŸ¥ åŸåˆ™ä¸Šåªå’ŒæŠ€æœ¯ç±»åšå®¢äº¤æ¢ï¼Œä½†ä¸åŒ…æ‹¬å«æœ‰å’Œè‰²æƒ…ã€æš´åŠ›ã€æ”¿æ²»æ•æ„Ÿçš„ç½‘ç«™ã€‚ ä¸å’Œå‰½çªƒã€ä¾µæƒã€æ— è¯šä¿¡çš„ç½‘ç«™äº¤æ¢ï¼Œä¼˜å…ˆå’Œå…·æœ‰åŸåˆ›ä½œå“çš„ç½‘ç«™äº¤æ¢ã€‚ ç”³è¯·è¯·æä¾›ï¼šç«™ç‚¹åç§°ã€ç«™ç‚¹é“¾æ¥ã€ç«™ç‚¹æè¿°ã€logoæˆ–å¤´åƒï¼ˆä¸è¦è®¾ç½®é˜²ç›—é“¾ï¼‰ã€‚ æ’åä¸åˆ†å…ˆåï¼Œåˆ·æ–°åé‡æ’ï¼Œæ›´æ–°ä¿¡æ¯åè¯·ç•™è¨€å‘ŠçŸ¥ã€‚ ä¼šå®šæœŸæ¸…ç†å¾ˆä¹…å¾ˆä¹…ä¸æ›´æ–°çš„ã€ä¸ç¬¦åˆè¦æ±‚çš„å‹é“¾ï¼Œä¸å†å¦è¡Œé€šçŸ¥ã€‚ æœ¬ç«™ä¸å­˜å‚¨å‹é“¾å›¾ç‰‡ï¼Œå¦‚æœå‹é“¾å›¾ç‰‡æ¢äº†æ— æ³•æ›´æ–°ã€‚å›¾ç‰‡è£‚äº†çš„ä¼šæ›¿æ¢æˆé»˜è®¤å›¾ï¼Œéœ€è¦æ›´æ¢çš„è¯·ç•™è¨€å‘ŠçŸ¥ã€‚ æœ¬ç«™å‹é“¾ä¿¡æ¯å¦‚ä¸‹ï¼Œç”³è¯·å‹é“¾å‰è¯·å…ˆæ·»åŠ æœ¬ç«™ä¿¡æ¯ï¼š ç½‘ç«™å›¾æ ‡ï¼šhttps://removeif.github.io/images/avatar.jpg ç½‘ç«™åç§°ï¼šè¾£æ¤’ã®é…± ç½‘ç«™åœ°å€ï¼šhttps://removeif.github.io ç½‘ç«™ç®€ä»‹ï¼šåç«¯å¼€å‘ï¼ŒæŠ€æœ¯åˆ†äº« åŠ è½½ä¸­ï¼Œç¨ç­‰å‡ ç§’...","link":"/friend/index.html"},{"title":"","text":"&nbsp;&nbsp;å¬å¬éŸ³ä¹ éŸ³ä¹æ’­æ”¾å™¨ç”±mePlayeræä¾›ï¼Œå¸ƒå±€å‚ç…§ç½‘å‹åšå®¢æ‰€ä½œï¼Œæ„Ÿè°¢ä½œè€…çš„è¾›å‹¤ä»˜å‡ºã€‚æ›´å¤šéŸ³ä¹åˆ†äº«è¯·æŸ¥çœ‹æ­Œå•ã€‚ &nbsp;&nbsp;çœ‹çœ‹è§†é¢‘ ->ç‚¹å‡»ä»¥ä¸‹æ¡ç›®å¼€å§‹æ’­æ”¾è§†é¢‘,å‘ä¸‹æ»‘åŠ¨æŸ¥çœ‹æ›´å¤š","link":"/media/index.html"},{"title":"","text":"æ¥è€Œä¸å¾€éç¤¼ä¹Ÿç•…æ‰€æ¬²è¨€ï¼Œæœ‰ç•™å¿…åº”","link":"/message/index.html"},{"title":"éŸ³ä¹æ­Œå•æ”¶è—","text":"æ¸©é¦¨æç¤ºï¼šé€‰æ‹©å–œæ¬¢çš„éŸ³ä¹åŒå‡»æ’­æ”¾ï¼Œç”±äºç‰ˆæƒåŸå› éƒ¨åˆ†ä¸èƒ½æ’­æ”¾ã€‚å¦‚æœå–œæ¬¢æ­Œå•æ”¶è—ä¸€ä¸‹ï¼Œå»ç½‘æ˜“äº‘éƒ½èƒ½æ’­æ”¾å“Ÿï¼","link":"/music/index.html"},{"title":"","text":"ç¢ç¢å¿µ tipsï¼šgithubç™»å½•åæŒ‰æ—¶é—´æ­£åºæŸ¥çœ‹ã€å¯ç‚¹èµåŠ â¤ï¸ã€æœ¬æ’ä»¶åœ°å€..ã€Œ+99æ¬¡æŸ¥çœ‹ã€ ç¢ç¢å¿µåŠ è½½ä¸­ï¼Œè¯·ç¨ç­‰... $.getScript(\"/js/gitalk_self.min.js\", function () { var gitalk = new Gitalk({ clientID: '46a9f3481b46ea0129d8', clientSecret: '79c7c9cb847e141757d7864453bcbf89f0655b24', id: '666666', repo: 'issue_database', owner: 'removeif', admin: \"removeif\", createIssueManually: true, distractionFreeMode: false }); gitalk.render('comment-container1'); });","link":"/self-talking/index.html"}],"posts":[{"title":"Kafkaæ¶ˆè´¹æŒ‡å®šæ—¶é—´æ®µæ¶ˆæ¯","text":"é€šè¿‡æ—¶é—´æˆ³æ‰¾åˆ°æ¯ä¸ªåˆ†åŒºå¯¹åº”çš„ä½ç‚¹ï¼Œæ¶ˆè´¹æ¯ä¸ªåˆ†åŒºä¸¤ä¸ªä½ç‚¹ä¹‹é—´çš„æ¶ˆæ¯ã€‚12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758class KafkaConsumerFromTimestamp: def __init__(self): self.consumer = KafkaConsumer(bootstrap_servers=kafkaConfig['host'], api_version=(0, 10, 2), session_timeout_ms=25000, max_poll_records=1000, fetch_max_bytes=1 * 1024 * 1024) self.consumer.subscribe([input['topic']]) self.endOffsetDict = {} self.parSet = set() self.getData() def getOffsets(self): self.consumer.poll(timeout_ms=100, max_records=100, update_offsets=True) assignment = self.consumer.assignment() startTime = int(time.time() - 61) * 1000 # 1 mins ago timestamp endTime = int(time.time() - 1) * 1000 # current timestamp # start timestamp timestampToSearch = {} partitionList = [] for tp in assignment: timestampToSearch[tp] = startTime partitionList.append(tp) startOffsets = self.consumer.offsets_for_times(timestampToSearch) # end timestamp timestampToSearch = {} partitionList = [] for tp in assignment: timestampToSearch[tp] = endTime partitionList.append(tp) endOffsets = self.consumer.offsets_for_times(timestampToSearch) # add endoffsets in dict for TopicPartition, OffsetAndTimestamp in endOffsets.items(): self.endOffsetDict['partition_' + str(TopicPartition.partition)] = OffsetAndTimestamp.offset # seek start point for tp in assignment: offsetAndTimestamp = startOffsets[tp] if offsetAndTimestamp is not None: self.consumer.seek(tp, offsetAndTimestamp.offset) def getData(self): self.getOffsets() for msg in self.consumer: msgOffset = msg.offset msgPartition = msg.partition # all partitions traversed then break if len(self.parSet) == 12: break # each partition traversed then continue if msgOffset &gt; self.endOffsetDict['partition_' + str(msgPartition)]: self.parSet.add(msgPartition) continue val = json.loads(msg.value) print(val) å¹¶ä¸æ˜¯æ‰€æœ‰çš„offsetæˆ–timestampéƒ½æœ‰æ¶ˆæ¯ï¼Œå¦‚ä½•æ‰¾åˆ°åˆé€‚çš„offsetæˆ–timeï¼Ÿ å…ˆseekToEndï¼Œå†è·å¾—positionï¼Œä¹Ÿå°±æ˜¯æ­¤æ—¶çš„offsetã€‚ 12self.consumer.seek_to_end(partition)self.consumer.position(partition) ç”¨consumer.endOffsets(partitions).get(TopicPartition) 12self.partition = TopicPartition(topic=myTopic, partition=myPartition)self.endingOffset = self.consumer.end_offsets(self.partition) åŒç†ï¼Œä¹Ÿæœ‰beginningOffsets() å¦‚æœæœ‰å¤šä¸ªtopic partitionï¼Œå¯ä»¥ç”¨ä¸€ä¸ªHashSetã€‚","link":"/2022/01/18/Kafka%E6%B6%88%E8%B4%B9%E6%8C%87%E5%AE%9A%E6%97%B6%E9%97%B4%E6%AE%B5%E6%B6%88%E6%81%AF/"},{"title":"Linux crontab å‘½ä»¤","text":"Linux crontabæ˜¯ç”¨æ¥å®šæœŸæ‰§è¡Œç¨‹åºçš„å‘½ä»¤ã€‚ å½“å®‰è£…å®Œæˆæ“ä½œç³»ç»Ÿä¹‹åï¼Œé»˜è®¤ä¾¿ä¼šå¯åŠ¨æ­¤ä»»åŠ¡è°ƒåº¦å‘½ä»¤ã€‚ crond å‘½ä»¤æ¯åˆ†é”ºä¼šå®šæœŸæ£€æŸ¥æ˜¯å¦æœ‰è¦æ‰§è¡Œçš„å·¥ä½œï¼Œå¦‚æœæœ‰è¦æ‰§è¡Œçš„å·¥ä½œä¾¿ä¼šè‡ªåŠ¨æ‰§è¡Œè¯¥å·¥ä½œã€‚ æ³¨æ„ï¼šæ–°åˆ›å»ºçš„ cron ä»»åŠ¡ï¼Œä¸ä¼šé©¬ä¸Šæ‰§è¡Œï¼Œè‡³å°‘è¦è¿‡ 2 åˆ†é’Ÿåæ‰å¯ä»¥ï¼Œå½“ç„¶ä½ å¯ä»¥é‡å¯ cron æ¥é©¬ä¸Šæ‰§è¡Œã€‚ Crontab é‡å¯å‘½ä»¤12# --é‡å¯å‘½ä»¤--/etc/init.d/cron restart æŸ¥çœ‹Crontabæ˜¯å¦å¯åŠ¨1sudo launchctl list | grep cron ç¼–è¾‘Crontabå†…å®¹1crontab -e Crontab æ–‡ä»¶æ ¼å¼ æ ¼å¼ ç¬¬1åˆ—ï¼šåˆ†é’Ÿï¼Œ0ï½59 ç¬¬2åˆ—ï¼šå°æ—¶ï¼Œ0ï½23 ç¬¬3åˆ—ï¼šæ—¥æœŸï¼Œ1ï½31 ç¬¬4åˆ—ï¼šæœˆä»½ï¼Œ1ï½12 ç¬¬5åˆ—ï¼šæ˜ŸæœŸï¼Œ0ï½7ï¼ˆ0å’Œ7è¡¨ç¤ºæ˜ŸæœŸå¤©ï¼‰ ç¬¬6åˆ—ï¼šè¦è¿è¡Œçš„å‘½ä»¤ï¼ˆå¦‚æœæœ‰å¤šä¸ªå‘½ä»¤ç”¨ &amp;&amp; éš”å¼€ï¼‰ ç‰¹æ®Šå­—ç¬¦ æ˜Ÿå·**(*)** ï¼šä»£è¡¨æ‰€æœ‰å¯èƒ½çš„å€¼ï¼Œä¾‹å¦‚ï¼Œmonthå­—æ®µå¦‚æœæ˜¯æ˜Ÿå·ï¼Œåˆ™è¡¨ç¤ºåœ¨æ»¡è¶³å…¶å®ƒå­—æ®µçš„åˆ¶çº¦æ¡ä»¶åï¼Œæ¯æœˆéƒ½æ‰§è¡Œè¯¥å‘½ä»¤æ“ä½œï¼› é€—å·**(,)** ï¼šå¯ä»¥ç”¨é€—å·éš”å¼€çš„å€¼ï¼ŒæŒ‡å®šä¸€ä¸ªå¤šå…ƒç´ çš„åˆ—è¡¨ï¼Œä¾‹å¦‚ï¼š1,2,5,7,8,9 ä¸­æ **(-)** ï¼šå¯ä»¥ç”¨æ•´æ•°ä¹‹é—´çš„ä¸­æ è¡¨ç¤ºä¸€ä¸ªæ•´æ•°èŒƒå›´ï¼Œä¾‹å¦‚â€œ2-6â€è¡¨ç¤ºï¼š2,3,4,5,6 æ­£æ–œçº¿**(/)** ï¼šå¯ä»¥ç”¨æ­£æ–œçº¿æŒ‡å®šæ—¶é—´çš„é—´éš”é¢‘ç‡ï¼Œä¾‹å¦‚â€œ0-23/2â€è¡¨ç¤ºæ¯ä¸¤å°æ—¶æ‰§è¡Œä¸€æ¬¡ã€‚åŒæ—¶æ­£æ–œçº¿å¯ä»¥å’Œæ˜Ÿå·ä¸€èµ·ä½¿ç”¨ï¼Œä¾‹å¦‚*/10ï¼Œå¦‚æœç”¨åœ¨minuteå­—æ®µï¼Œè¡¨ç¤ºæ¯ååˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡ã€‚ ç¤ºä¾‹ æ¯1åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡ 1*/1 * * * * æ¯éš”ä¸¤å¤©çš„ä¸Šåˆ8ç‚¹åˆ°11ç‚¹çš„ç¬¬3å’Œç¬¬15åˆ†é’Ÿæ‰§è¡Œ 13,15 8-11 */2 * * æ¯ä¸ªæ˜ŸæœŸä¸€çš„ä¸Šåˆ8ç‚¹åˆ°11ç‚¹çš„ç¬¬3å’Œç¬¬15åˆ†é’Ÿæ‰§è¡Œ 13,15 8-11 * * 1 æ¯æœˆçš„4å·ä¸æ¯å‘¨ä¸€åˆ°å‘¨ä¸‰çš„11ç‚¹é‡å¯smb 10 11 4 * mon-wed /etc/init.d/smb restart æ¯å°æ—¶æ‰§è¡Œ/etc/cron.hourlyç›®å½•å†…çš„è„šæœ¬ 101 * * * * root run-parts /etc/cron.hourly è¯´æ˜ï¼šrun-partsè¿™ä¸ªå‚æ•°ï¼Œå¦‚æœå»æ‰è¿™ä¸ªå‚æ•°çš„è¯ï¼Œåé¢å°±å¯ä»¥å†™è¦è¿è¡Œçš„æŸä¸ªè„šæœ¬åï¼Œè€Œä¸æ˜¯ç›®å½•åäº†ã€‚ è·¯å¾„é—®é¢˜ å•ç‹¬æ‰§è¡Œå®šæ—¶ä»»åŠ¡æ—¶å€™æ²¡æœ‰é—®é¢˜ï¼Œå•ç‹¬æ‰§è¡Œpythonè„šæœ¬æ²¡æœ‰é—®é¢˜ï¼Œæ­¤å®šæ—¶ä»»åŠ¡ä¸æ‰§è¡ŒåŸå› æ˜¯å› ä¸ºpythonè·¯å¾„è¦å†™ç»å¯¹è·¯å¾„ é¦–å…ˆåœ¨linuxä¸Šæ‰§è¡Œå‘½ä»¤ï¼šwhere is python3.8 æˆ–è€… which python3.8ï¼Œå¾—åˆ°pythonçš„ç»å¯¹è·¯å¾„ 12which python3.8/usr/local/bin/python3.8 è®¾å®šæ‰§è¡Œä»»åŠ¡ 130 8 * * * /usr/local/bin/python3.8 /user/loacl/bin/***/***.py","link":"/2022/01/14/Linux-crontab-%E5%91%BD%E4%BB%A4/"},{"title":"Mysqlå¯¼å…¥å¯¼å‡ºæ•°æ®","text":"å¯¼å…¥Excelï¼šå‡†å¤‡.txtæ–‡ä»¶ å°†è¦å¯¼å…¥çš„æ•°æ®ï¼ˆä¸å«è¡¨å¤´ï¼‰ä»å·¥ä½œè¡¨å¤åˆ¶ã€ç²˜è´´åˆ°ä¸€ä¸ªæ–°å»ºçš„Excelæ•°æ®è¡¨ä¸­ï¼ˆé¿å…æ±¡æŸ“æºæ•°æ®ï¼‰ ç²˜è´´æ—¶æ³¨æ„ï¼šä½¿ç”¨å³é”®paste as valueé€‰é¡¹ï¼Œè¿‡æ»¤æ‰æºæ•°æ®è¡¨ä¸­çš„å¤šä½™æ ¼å¼ï¼ˆå¦‚ï¼Œå­—ä½“é¢œè‰²ã€ç²—ä½“ç­‰ï¼‰ å°†æ–°å»ºçš„Excelæ–‡æ¡£ï¼ˆåªå«ä¸€å¼ æ•°æ®è¡¨ï¼‰å¦å­˜ä¸ºunicodeæ–‡æœ¬ï¼ˆè¯•è¿‡.csvæ ¼å¼ï¼Œä¸å¥½ç”¨ï¼‰ å…³é—­å¦å­˜ä¸ºåçš„Excelæ–‡æ¡£ï¼Œåœ¨èµ„æºç®¡ç†å™¨ä¸­ç”¨è®°äº‹æœ¬æ‰“å¼€è¯¥æ–‡æ¡£ï¼Œç‚¹å‡»â€œå¦å­˜ä¸ºâ€œæŒ‰é’®ï¼Œå‘ç°ç¼–ç æ ¼å¼ä¸ºâ€œUnicodeâ€ï¼Œå°†æ­¤é¡¹æ›´æ”¹ä¸ºâ€œUTF-8â€ï¼Œè¦†ç›–æºæ–‡ä»¶ã€‚ï¼ˆè¿™ä¸€æ­¥å¾ˆå…³é”®ï¼Œå¦‚æœç¼ºå°‘ï¼Œåˆ™åœ¨å¯¼å…¥.txtæ–‡ä»¶æ—¶Mysqlä¼šæŠ¥å‡ºè®©äººè´¹è§£çš„é”™è¯¯ï¼šinvalid utf8 character string â€˜â€™ï¼‰ å»ºè¡¨ã€å¯¼å…¥.txtæ–‡ä»¶ æ ¹æ®Excelæ•°æ®è¡¨çš„ç»“æ„ï¼Œè®¾è®¡Mysqlè¡¨ç»“æ„ï¼ˆæ„Ÿè§‰Textæ ¼å¼æ¯”varcharå¥½ç”¨ï¼Œä¸ç”¨å…³å¿ƒå„å­—æ®µçš„é•¿åº¦é—®é¢˜ï¼‰ åˆ›å»ºè¡¨ï¼šCreate table term (type text, subtype text, en text, cn text, chd text) character set=utf8; ä½¿ç”¨Load Data InFile â€˜D:/sample.txtâ€™ Into Table terms lines terminated by â€˜\\r\\nâ€™;è¯­å¥å¯¼å…¥.txtï¼ŒæˆåŠŸï¼ å¯¼å‡ºExcelï¼š1SELECT * into outfile '/Users/panxiao/Desktop/Export/region.xlsx' FROM region; Maxcompute tunnel å¯¼å…¥ Import as .csv file(partition by ,) then save as txt encoding with utf-8 Tunnel upload /Users/panxiao/Desktop/xxx.txt table_name","link":"/2022/01/07/Mysql%E5%AF%BC%E5%85%A5%E5%AF%BC%E5%87%BA%E6%95%B0%E6%8D%AE/"},{"title":"Python è·å–ç›®å½•","text":"Python è·å–å½“å‰ç›®å½•, ä¸Šçº§ç›®å½•, ä¸Šä¸Šçº§ç›®å½•123456789101112131415# --run--import osprint '***è·å–å½“å‰ç›®å½•***'print os.getcwd()print os.path.abspath(os.path.dirname(__file__))print '***è·å–ä¸Šçº§ç›®å½•***'print os.path.abspath(os.path.dirname(os.path.dirname(__file__)))print os.path.abspath(os.path.dirname(os.getcwd()))print os.path.abspath(os.path.join(os.getcwd(), &quot;..&quot;))print os.path.abspath('.')print '***è·å–ä¸Šä¸Šçº§ç›®å½•***'print os.path.abspath(os.path.join(os.getcwd(), &quot;../..&quot;))","link":"/2022/01/07/Python-%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E7%9B%AE%E5%BD%95-%E4%B8%8A%E7%BA%A7%E7%9B%AE%E5%BD%95-%E4%B8%8A%E4%B8%8A%E7%BA%A7%E7%9B%AE%E5%BD%95/"},{"title":"Pythonå¤šçº¿ç¨‹ä¸å¤šçº¿ç¨‹ä¸­join()çš„ç”¨æ³•","text":"Pythonå¤šçº¿ç¨‹ä¸å¤šè¿›ç¨‹ä¸­join()æ–¹æ³•çš„æ•ˆæœæ˜¯ç›¸åŒçš„ã€‚ é¦–å…ˆéœ€è¦æ˜ç¡®å‡ ä¸ªæ¦‚å¿µï¼š ä¸€ã€ å½“ä¸€ä¸ªè¿›ç¨‹å¯åŠ¨ä¹‹åï¼Œä¼šé»˜è®¤äº§ç”Ÿä¸€ä¸ªä¸»çº¿ç¨‹ï¼Œå› ä¸ºçº¿ç¨‹æ˜¯ç¨‹åºæ‰§è¡Œæµçš„æœ€å°å•å…ƒï¼Œå½“è®¾ç½®å¤šçº¿ç¨‹æ—¶ï¼Œä¸»çº¿ç¨‹ä¼šåˆ›å»ºå¤šä¸ªå­çº¿ç¨‹ï¼Œåœ¨pythonä¸­ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼ˆå…¶å®å°±æ˜¯setDaemon(False)ï¼‰ï¼Œä¸»çº¿ç¨‹æ‰§è¡Œå®Œè‡ªå·±çš„ä»»åŠ¡ä»¥åï¼Œå°±é€€å‡ºäº†ï¼Œæ­¤æ—¶å­çº¿ç¨‹ä¼šç»§ç»­æ‰§è¡Œè‡ªå·±çš„ä»»åŠ¡ï¼Œç›´åˆ°è‡ªå·±çš„ä»»åŠ¡ç»“æŸã€‚123456789101112131415161718192021222324import threadingimport timedef run(): time.sleep(2) print('å½“å‰çº¿ç¨‹çš„åå­—æ˜¯ï¼š ', threading.current_thread().name) time.sleep(2)if __name__ == '__main__': start_time = time.time() print('è¿™æ˜¯ä¸»çº¿ç¨‹ï¼š', threading.current_thread().name) thread_list = [] for i in range(5): t = threading.Thread(target=run) thread_list.append(t) for t in thread_list: t.start() print('ä¸»çº¿ç¨‹ç»“æŸï¼' , threading.current_thread().name) print('ä¸€å…±ç”¨æ—¶ï¼š', time.time()-start_time) å…¶æ‰§è¡Œç»“æœå¦‚ä¸‹: 12345678910è¿™æ˜¯ä¸»çº¿ç¨‹: MainThreadä¸»çº¿ç¨‹ç»“æŸäº†ï¼ MainThreadä¸€å…±ç”¨æ—¶: 0.0010004043579101562å½“å‰çº¿ç¨‹çš„åå­—æ˜¯: Thread-1å½“å‰çº¿ç¨‹çš„åå­—æ˜¯: Thread-5å½“å‰çº¿ç¨‹çš„åå­—æ˜¯: Thread-4å½“å‰çº¿ç¨‹çš„åå­—æ˜¯: Thread-3å½“å‰çº¿ç¨‹çš„åå­—æ˜¯: Thread-2Process finished with exit code 0 å…³é”®ç‚¹: æˆ‘ä»¬çš„è®¡æ—¶æ˜¯å¯¹ä¸»çº¿ç¨‹è®¡æ—¶ï¼Œä¸»çº¿ç¨‹ç»“æŸï¼Œè®¡æ—¶éšä¹‹ç»“æŸï¼Œæ‰“å°å‡ºä¸»çº¿ç¨‹çš„ç”¨æ—¶ã€‚ ä¸»çº¿ç¨‹çš„ä»»åŠ¡å®Œæˆä¹‹åï¼Œä¸»çº¿ç¨‹éšä¹‹ç»“æŸï¼Œå­çº¿ç¨‹ç»§ç»­æ‰§è¡Œè‡ªå·±çš„ä»»åŠ¡ï¼Œç›´åˆ°å…¨éƒ¨çš„å­çº¿ç¨‹çš„ä»»åŠ¡å…¨éƒ¨ç»“æŸï¼Œç¨‹åºç»“æŸã€‚ äºŒã€ å½“æˆ‘ä»¬ä½¿ç”¨setDaemon(True)æ–¹æ³•ï¼Œè®¾ç½®å­çº¿ç¨‹ä¸ºå®ˆæŠ¤çº¿ç¨‹æ—¶ï¼Œä¸»çº¿ç¨‹ä¸€æ—¦æ‰§è¡Œç»“æŸï¼Œåˆ™å…¨éƒ¨çº¿ç¨‹å…¨éƒ¨è¢«ç»ˆæ­¢æ‰§è¡Œï¼Œå¯èƒ½å‡ºç°çš„æƒ…å†µå°±æ˜¯ï¼Œå­çº¿ç¨‹çš„ä»»åŠ¡è¿˜æ²¡æœ‰å®Œå…¨æ‰§è¡Œç»“æŸï¼Œå°±è¢«è¿«åœæ­¢ã€‚1234567891011121314151617181920212223242526import threadingimport timedef run(): time.sleep(2) print('å½“å‰çº¿ç¨‹çš„åå­—æ˜¯ï¼š ', threading.current_thread().name) time.sleep(2)if __name__ == '__main__': start_time = time.time() print('è¿™æ˜¯ä¸»çº¿ç¨‹ï¼š', threading.current_thread().name) thread_list = [] for i in range(5): t = threading.Thread(target=run) thread_list.append(t) for t in thread_list: t.setDaemon(True) t.start() print('ä¸»çº¿ç¨‹ç»“æŸäº†ï¼' , threading.current_thread().name) print('ä¸€å…±ç”¨æ—¶ï¼š', time.time()-start_time) å…¶æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼Œæ³¨æ„è¯·ç¡®ä¿setDaemon()åœ¨start()ä¹‹å‰ã€‚ 12345è¿™æ˜¯ä¸»çº¿ç¨‹: MainThreadä¸»çº¿ç¨‹ç»“æŸäº†! mainThreadä¸€å…±ç”¨æ—¶: 0.0010006427764892578Process finished with exit code 0 å…³é”®ç‚¹ï¼š éå¸¸æ˜æ˜¾çš„çœ‹åˆ°ï¼Œä¸»çº¿ç¨‹ç»“æŸä»¥åï¼Œå­çº¿ç¨‹è¿˜æ²¡æœ‰æ¥å¾—åŠæ‰§è¡Œï¼Œæ•´ä¸ªç¨‹åºå°±é€€å‡ºäº†ã€‚ ä¸‰ã€ æ­¤æ—¶joinçš„ä½œç”¨å°±å‡¸æ˜¾å‡ºæ¥äº†ï¼Œjoinæ‰€å®Œæˆçš„å·¥ä½œå°±æ˜¯çº¿ç¨‹åŒæ­¥ï¼Œå³ä¸»çº¿ç¨‹ä»»åŠ¡ç»“æŸä¹‹åï¼Œè¿›å…¥é˜»å¡çŠ¶æ€ï¼Œä¸€ç›´ç­‰å¾…å…¶ä»–çš„å­çº¿ç¨‹æ‰§è¡Œç»“æŸä¹‹åï¼Œä¸»çº¿ç¨‹åœ¨ç»ˆæ­¢ã€‚1234567891011121314151617181920212223242526272829import threadingimport timedef run(): time.sleep(2) print('å½“å‰çº¿ç¨‹çš„åå­—æ˜¯ï¼š ', threading.current_thread().name) time.sleep(2)if __name__ == '__main__': start_time = time.time() print('è¿™æ˜¯ä¸»çº¿ç¨‹ï¼š', threading.current_thread().name) thread_list = [] for i in range(5): t = threading.Thread(target=run) thread_list.append(t) for t in thread_list: t.setDaemon(True) t.start() for t in thread_list: t.join() print('ä¸»çº¿ç¨‹ç»“æŸäº†ï¼' , threading.current_thread().name) print('ä¸€å…±ç”¨æ—¶ï¼š', time.time()-start_time) å…¶æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š 12345678910è¿™æ˜¯ä¸»çº¿ç¨‹: MainThreadå½“å‰çº¿ç¨‹çš„åå­—æ˜¯: Thread-2å½“å‰çº¿ç¨‹çš„åå­—æ˜¯: Thread-1å½“å‰çº¿ç¨‹çš„åå­—æ˜¯: Thread-3å½“å‰çº¿ç¨‹çš„åå­—æ˜¯: Thread-5å½“å‰çº¿ç¨‹çš„åå­—æ˜¯: Thread-4ä¸»çº¿ç¨‹ç»“æŸäº†! MainThreadä¸€å…±ç”¨æ—¶: 4.002500057220459Process finished with exit code 0 å…³é”®ç‚¹ï¼š å¯ä»¥çœ‹åˆ°ï¼Œä¸»çº¿ç¨‹ä¸€ç›´ç­‰å¾…å…¨éƒ¨çš„å­çº¿ç¨‹ç»“æŸä¹‹åï¼Œä¸»çº¿ç¨‹è‡ªèº«æ‰ç»“æŸï¼Œç¨‹åºé€€å‡ºã€‚ å››ã€ joinæœ‰ä¸€ä¸ªtimeoutå‚æ•°ï¼š å½“è®¾ç½®å®ˆæŠ¤çº¿ç¨‹æ—¶ï¼Œå«ä¹‰æ˜¯ä¸»çº¿ç¨‹å¯¹äºå­çº¿ç¨‹ç­‰å¾…timeoutçš„æ—¶é—´å°†ä¼šæ€æ­»è¯¥å­çº¿ç¨‹ï¼Œæœ€åé€€å‡ºç¨‹åºã€‚æ‰€ä»¥è¯´ï¼Œå¦‚æœæœ‰10ä¸ªå­çº¿ç¨‹ï¼Œå…¨éƒ¨çš„ç­‰å¾…æ—¶é—´å°±æ˜¯æ¯ä¸ªtimeoutçš„ç´¯åŠ å’Œã€‚ç®€å•çš„æ¥è¯´ï¼Œå°±æ˜¯ç»™æ¯ä¸ªå­çº¿ç¨‹ä¸€ä¸ªtimeoutçš„æ—¶é—´ï¼Œè®©ä»–å»æ‰§è¡Œï¼Œæ—¶é—´ä¸€åˆ°ï¼Œä¸ç®¡ä»»åŠ¡æœ‰æ²¡æœ‰å®Œæˆï¼Œç›´æ¥æ€æ­»ã€‚ æ²¡æœ‰è®¾ç½®å®ˆæŠ¤çº¿ç¨‹æ—¶ï¼Œä¸»çº¿ç¨‹å°†ä¼šç­‰å¾…timeoutçš„ç´¯åŠ å’Œè¿™æ ·çš„ä¸€æ®µæ—¶é—´ï¼Œæ—¶é—´ä¸€åˆ°ï¼Œä¸»çº¿ç¨‹ç»“æŸï¼Œä½†æ˜¯å¹¶æ²¡æœ‰æ€æ­»å­çº¿ç¨‹ï¼Œå­çº¿ç¨‹ä¾ç„¶å¯ä»¥ç»§ç»­æ‰§è¡Œï¼Œç›´åˆ°å­çº¿ç¨‹å…¨éƒ¨ç»“æŸï¼Œç¨‹åºé€€å‡ºã€‚","link":"/2022/01/19/Python%E5%A4%9A%E7%BA%BF%E7%A8%8B%E4%B8%8E%E5%A4%9A%E7%BA%BF%E7%A8%8B%E4%B8%ADjoin-%E7%9A%84%E7%94%A8%E6%B3%95/"},{"title":"PaddleOCRæ¥å£è®¾è®¡","text":"ocr.py1234567891011121314from paddleocr import PaddleOCRfrom recognition import Recongnitionclass ocr: def __init__(self): self.ocr = PaddleOCR(use_angle_cls=True, use_gpu=False, lang='ch', cls_model_dir='./PaddleOCR/inference/ch_ppocr_mobile_v2.0_cls_infer', det_model_dir='./PaddleOCR/inference/ch_ppocr_mobile_v2.0_det_infer', rec_model_dir='./PaddleOCR/inference/ch_ppocr_mobile_v2.0_rec_infer', rec_char_dict_path='./PaddleOCR/ppocr/utils/ppocr_keys_v1.txt') def run(self, imgsrc): rec = Recongnition(imgsrc, self.ocr) return rec.ImagRecognition() recognition.py123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101from PIL import Imageclass Recongnition: def __init__(self, imgsrc, ocr): self.imgsrc = imgsrc self.ocr = ocr self.date = time.strftime(&quot;%Y%m%d&quot;, time.localtime()) # åˆ†è¾¨ç‡ç»Ÿä¸€è½¬æ¢æˆ1080p def transfer(self, file): img = Image.open(file) size = img.size if size[0] != 1080 and size[1] != 1920: reim = img.resize((1080, 1920)) reim.save(file) # å›¾ç‰‡å‰ªè£ def cutImg(self, coordinate, imagPath): &quot;&quot;&quot;æ ¹æ®åæ ‡ä½ç½®å‰ªåˆ‡å›¾ç‰‡ :param imgsrc: åŸå§‹å›¾ç‰‡è·¯å¾„(str) :param coordinate: åŸå§‹å›¾ç‰‡ä¸Šçš„åæ ‡(tuple) egg:(x, y, w, h) ---&gt; x,yä¸ºçŸ©å½¢å·¦ä¸Šè§’åæ ‡, w,hä¸ºå³ä¸‹è§’åæ ‡ :param imagPath: å‰ªåˆ‡è¾“å‡ºå›¾ç‰‡è·¯å¾„(str) :return: None &quot;&quot;&quot; image = Image.open(self.imgsrc) region = image.crop(coordinate) # äº®åº¦å¢å¼º # region = ImageEnhance.Brightness(region).enhance(1.5) # è‰²åº¦å¢å¼º # region = ImageEnhance.Color(region).enhance(1.5) # å¯¹æ¯”åº¦å¢å¼º # region = ImageEnhance.Contrast(region).enhance(1.5) # é”åº¦å¢å¼º # region = ImageEnhance.Sharpness(region).enhance(3.0) region.save(imagPath) # å›¾ç‰‡è¯†åˆ« def ImagRecognition(self): # åˆ‡å‰²æ‰èƒŒæ™¯å›¾ image = Image.open(self.imgsrc) size = image.size source = self.imgsrc.split('/')[-1] box = (0, int(size[1] * 0.1), int(size[0]), int(size[1])) if not os.path.exists('./dataset/douyin_crop/' + self.date): os.mkdir('./dataset/douyin_crop/' + self.date) imagPath = './dataset/douyin_crop/' + self.date + '/' + source self.cutImg(box, imagPath) self.transfer(imagPath) # åˆå§‹åŒ– result = self.ocr.ocr(imagPath, cls=True) image = Image.open(imagPath) size = image.size rectangle = {}.fromkeys(['æŠ–éŸ³å·', 'è·èµ', 'å…³æ³¨', 'ç²‰ä¸'], None) userInfo = {}.fromkeys(['nickName', 'userId', 'likesCount', 'fans', 'æœ¬äºº'], None) userInfo['nickName'] = '' # ç¬¬ä¸€æ¬¡éå† for line in result: # å­˜æŠ–éŸ³å·åŠå…³é”®å­—åæ ‡ if line[1][0].find('æŠ–éŸ³å·') != -1: rectangle.update({'æŠ–éŸ³å·': line[0]}) pattern = re.compile(r'[æŠ–éŸ³å·ï¼š\\u4e00-\\u9fa5]') userInfo.update({'userId': re.sub(pattern, &quot;&quot;, line[1][0])}) if line[1][0] == 'è·èµ' and rectangle['è·èµ'] is None: rectangle.update({'è·èµ': line[0]}) if line[1][0] == 'å…³æ³¨' and rectangle['å…³æ³¨'] is None: rectangle.update({'å…³æ³¨': line[0]}) if line[1][0] == 'ç²‰ä¸' and rectangle['ç²‰ä¸'] is None: rectangle.update({'ç²‰ä¸': line[0]}) if line[1][0].find('ç¼–è¾‘èµ„æ–™') != -1 or line[1][0].find('æ·»åŠ æœ‹å‹') != -1: userInfo.update({'æœ¬äºº': 'æ˜¯'}) # éæœ¬äºº if userInfo['æœ¬äºº'] is None: print('éæœ¬äººä¸»é¡µ') return None else: userInfo.pop('æœ¬äºº') # æœªè¯†åˆ« if rectangle['æŠ–éŸ³å·'] is None or rectangle['è·èµ'] is None or rectangle['å…³æ³¨'] is None or rectangle['ç²‰ä¸'] is None: print('æœªè¯†åˆ«') return None # ç¬¬äºŒæ¬¡éå†, æ ¹æ®åæ ‡è®¡ç®—æ‰€éœ€å­—æ®µå†…å®¹ for line in result: if line[0][0][0] &gt; rectangle['è·èµ'][0][0] - int(size[0] * 0.08) and line[0][1][0] &lt; int(size[0] * 0.5) \\ and line[0][3][1] &lt; rectangle['è·èµ'][3][1] + int(size[1] * 0.05) and line[0][0][1] &gt; rectangle['è·èµ'][3][1] and userInfo['likesCount'] is None: userInfo.update({'likesCount': line[1][0]}) if line[0][3][1] &lt; rectangle['ç²‰ä¸'][3][1] + int(size[1] * 0.05) and line[0][0][1] &gt; rectangle['ç²‰ä¸'][3][1] \\ and rectangle['ç²‰ä¸'][0][0] &lt; int((line[0][0][0] + line[0][1][0]) / 2) &lt; rectangle['ç²‰ä¸'][1][0] and userInfo['fans'] is None: userInfo.update({'fans': line[1][0]}) if line[0][2][1] &lt; rectangle['æŠ–éŸ³å·'][1][1] and line[0][0][1] &gt; rectangle['æŠ–éŸ³å·'][0][1] - int(size[1] * 0.07): userInfo['nickName'] += line[1][0] return userInfo api.py12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152import sys, osfrom ocrAPI import ocrAPIfrom aiohttp import webasync def postOCR(request): try: try: data = await request.json() except: data = {} print('postCommodityCategory start ==&gt; {} {} {}'.format( request.url, data, request.transport.get_extra_info('peername'))) try: url = data['url'] platform = data['platform'] except: url = &quot;&quot; platform = &quot;&quot; if not data: return web.json_response({ &quot;code&quot;: -1, &quot;message&quot;: &quot;å¤±è´¥&quot;, &quot;data&quot;: &quot;å‚æ•°ä¸å…¨&quot; }) usr_info = recognizer.paddleOCR(url, platform) rsp = { &quot;code&quot;: 1, &quot;message&quot;: &quot;æˆåŠŸ&quot;, &quot;data&quot;: usr_info } return web.json_response(rsp) except Exception as e: rsp = { &quot;code&quot;: -1, &quot;message&quot;: &quot;å¤±è´¥&quot;, &quot;data&quot;: str(e), } print('postOCR error ==&gt; {} {}'.format( request.transport.get_extra_info('peername'), str(e))) return web.json_response(rsp)app = web.Application()app.router.add_post('/ocr', postOCR)if __name__ == '__main__': recognizer = ocrAPI() web.run_app(app, host='0.0.0.0', port=5001)","link":"/2022/01/18/PaddleOCR%E6%8E%A5%E5%8F%A3%E8%AE%BE%E8%AE%A1/"},{"title":"asyncpgå¼‚æ­¥æ“ä½œPostgreSql","text":"å¼‚æ­¥æ“ä½œ PostgreSQL çš„è¯ï¼Œæˆ‘ä»¬æœ‰ä¸¤ä¸ªé€‰æ‹©ï¼Œä¸€ä¸ªæ˜¯ asyncpg åº“ï¼Œå¦ä¸€ä¸ªæ˜¯ aiopg åº“ã€‚ asyncpg æ˜¯è‡ªå·±å®ç°äº†ä¸€å¥—è¿æ¥é©±åŠ¨ï¼Œè€Œ aiopg åˆ™æ˜¯å¯¹ psycopg2 è¿›è¡Œäº†å°è£…ï¼Œä¸ªäººæ›´æ¨è asyncpgï¼Œæ€§èƒ½å’Œæ´»è·ƒåº¦éƒ½æ¯” aiopg è¦å¥½ã€‚ ä¸‹é¢æ¥çœ‹çœ‹å¦‚ä½•ä½¿ç”¨ asyncpgï¼Œé¦–å…ˆæ˜¯å®‰è£…ï¼Œç›´æ¥ pip install asyncpg å³å¯ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940# --run--import asyncioimport asyncpgclass asyncHandle(): async def asyncSearch(self): sql = ''' ''' row1 = await conn.fetchrow(sql) row2 = await conn.fetch(sql) return row1, row2 async def asyncInsert(self, data): self.conn = await asyncpg.connect(host=&quot;&quot;, port=, database='', user='', password='') tasks = [] tasks.append(asyncio.get_event_loop().create_task(self.task1(data))) tasks.append(asyncio.get_event_loop().create_task(self.task2(data))) tasks.append(asyncio.get_event_loop().create_task(self.task3(data))) await asyncio.gather(*tasks) async def task1(self, data): sql = ''' ''' await self.conn.execute(sql) async def task2(self, data): sql = ''' ''' await self.conn.execute(sql) async def task3(self, data): sql = ''' ''' await self.conn.execute(sql)","link":"/2022/01/11/asyncpg%E5%BC%82%E6%AD%A5%E6%93%8D%E4%BD%9CPostgreSql/"},{"title":"Hello World","text":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new &quot;My New Post&quot; More info: Writing Run server1$ hexo server More info: Server Generate static files1$ hexo generate More info: Generating Deploy to remote sites1$ hexo deploy More info: Deployment","link":"/2022/01/07/hello-world/"},{"title":"nohup å‘½ä»¤è¾“å‡ºåˆ°æŒ‡å®šæ–‡ä»¶","text":"åœ¨linuxä¸­è¿è¡Œå‘½ä»¤è¡Œæ—¶ï¼Œä¼šè¾“å‡ºä¸€äº›æ—¥å¿—ä¿¡æ¯ï¼Œç‰¹åˆ«å…¸å‹çš„æ˜¯å¯ç”¨WebLogicå‘½ä»¤æ—¶ï¼Œè¾“å‡ºä¸€äº›ä¿¡æ¯ï¼Œå½“å¯ç”¨demonæ¨¡å¼è¿è¡Œæ—¶ï¼Œåˆæƒ³æ”¶é›†è¿™äº›ä¿¡æ¯å’‹åŠï¼Ÿ è§£å†³çš„åŠæ³•å°±æ˜¯ä½¿ç”¨è¾“å‡ºé‡å®šå‘ï¼Œå¦‚ä¸‹é¢çš„å‘½ä»¤ï¼š 1nohup ./run &gt;log 2&gt;&amp;1 &amp; å…¶ä¸­ logæ˜¯ä¿å­˜è¾“å‡ºçš„æ–‡ä»¶åç§°ï¼› 2&gt;&amp;1 è¡¨ç¤ºä¸ä»…å‘½ä»¤è¡Œæ­£å¸¸çš„è¾“å‡ºä¿å­˜åˆ°logä¸­ï¼Œäº§ç”Ÿé”™è¯¯ä¿¡æ¯çš„è¾“å‡ºä¹Ÿä¿å­˜åˆ°logæ–‡ä»¶ä¸­ï¼› &amp; è¡¨ç¤ºè¯¥è¿›ç¨‹åœ¨åå°è¿è¡Œï¼› nohupè¡¨ç¤ºè¿›ç¨‹åœ¨å½“ç”¨æˆ·æ³¨é”€ï¼ˆlogoutï¼‰æˆ–è€…ç½‘ç»œæ–­å¼€æ—¶ä¸ä¼šè¢«ç»ˆæ­¢ã€‚ æ³¨æ„ï¼šè¿™é‡Œè‹¥ä¸æŒ‡å®šè¾“å‡ºæ—¥å¿—æ–‡ä»¶ï¼Œç¼ºçœåœ°ä¼šè¾“å‡ºåˆ°nohup.outæ–‡ä»¶ä¸­","link":"/2022/01/13/nohup-%E5%91%BD%E4%BB%A4%E8%BE%93%E5%87%BA%E5%88%B0%E6%8C%87%E5%AE%9A%E6%96%87%E4%BB%B6/"},{"title":"pythonä»£ç ä¼˜åŒ–cProfileçš„ç”¨æ³•","text":"cProfile è¾“å‡ºprofileåˆ°result.out1python -m cProfile -o result.out -s cumulative test.py æ³¨ï¼šä¹Ÿå¯åœ¨æ§åˆ¶å°æŸ¥çœ‹ï¼Œåˆ æ‰-oé€‰é¡¹ï¼Œä¹Ÿçœå»æ­¥éª¤21python3 -m cProfile -s cumulative test.py 2.result.outä¸ºäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œéœ€è¦å†å†™ä¸€ä¸ªpythonè„šæœ¬æŸ¥çœ‹ï¼š 123456import pstatsp=pstats.Stats('result.out')p.print_stats()p.sort_stats('calls').print_stats()p.sort_stats('cumulative').print_stats() å…¶ä¸­ï¼ŒcProfileå‡ºçš„å„ä¸ªå‚æ•°ï¼š ncallsï¼šè¡¨ç¤ºå‡½æ•°è°ƒç”¨çš„æ¬¡æ•°ï¼› tottimeï¼šè¡¨ç¤ºæŒ‡å®šå‡½æ•°çš„æ€»çš„è¿è¡Œæ—¶é—´ï¼Œé™¤æ‰å‡½æ•°ä¸­è°ƒç”¨å­å‡½æ•°çš„è¿è¡Œæ—¶é—´ï¼› percallï¼šï¼ˆç¬¬ä¸€ä¸ªpercallï¼‰ç­‰äº tottime/ncallsï¼› cumtimeï¼šè¡¨ç¤ºè¯¥å‡½æ•°åŠå…¶æ‰€æœ‰å­å‡½æ•°çš„è°ƒç”¨è¿è¡Œçš„æ—¶é—´ï¼Œå³å‡½æ•°å¼€å§‹è°ƒç”¨åˆ°è¿”å›çš„æ—¶é—´ï¼› percallï¼šï¼ˆç¬¬äºŒä¸ªpercallï¼‰å³å‡½æ•°è¿è¡Œä¸€æ¬¡çš„å¹³å‡æ—¶é—´ï¼Œç­‰äº cumtime/ncallsï¼› filename:lineno(function)ï¼šæ¯ä¸ªå‡½æ•°è°ƒç”¨çš„å…·ä½“ä¿¡æ¯","link":"/2022/01/07/python%E4%BB%A3%E7%A0%81%E4%BC%98%E5%8C%96cProfile%E7%9A%84%E7%94%A8%E6%B3%95/"},{"title":"ä½¿ç”¨scpå‘½ä»¤å®ç°æœåŠ¡å™¨ä¸Šä¼ ä¸‹è½½","text":"1ã€ä»æœåŠ¡å™¨ä¸Šä¸‹è½½æ–‡ä»¶ scp username@servername:/path/filename /Users/mac/Desktopï¼ˆæœ¬åœ°ç›®å½•ï¼‰ ä¾‹å¦‚: 1scp root@115.29.175.142:/root/test.txt /Users/mac/Desktop å°±æ˜¯å°†æœåŠ¡å™¨ä¸Šçš„/root/test.txtä¸‹è½½åˆ°æœ¬åœ°çš„/Users/mac/Desktopç›®å½•ä¸‹ã€‚æ³¨æ„ä¸¤ä¸ªåœ°å€ä¹‹é—´æœ‰ç©ºæ ¼ï¼ 2ã€ä¸Šä¼ æœ¬åœ°æ–‡ä»¶åˆ°æœåŠ¡å™¨ scp /path/filename username@servername:/path ä¾‹å¦‚: 1scp /Users/mac/Desktop/test.txt root@115.29.175.142:/root/ 3ã€ä»æœåŠ¡å™¨ä¸‹è½½æ•´ä¸ªç›®å½• scp -r username@servername:/root/ï¼ˆè¿œç¨‹ç›®å½•ï¼‰ /Users/mac/Desktopï¼ˆæœ¬åœ°ç›®å½•ï¼‰ ä¾‹å¦‚: 1scp -r root@115.29.175.142:/root/ /Users/mac/Desktop/ 4ã€ä¸Šä¼ ç›®å½•åˆ°æœåŠ¡å™¨ scp -r local_dir username@servername:remote_dir ä¾‹å¦‚ï¼š 1scp -r test root@115.29.175.142:/root/ æŠŠå½“å‰ç›®å½•ä¸‹çš„testç›®å½•ä¸Šä¼ åˆ°æœåŠ¡å™¨çš„/root/ ç›®å½• æ³¨ï¼šç›®æ ‡æœåŠ¡å™¨è¦å¼€å¯å†™å…¥æƒé™ã€‚","link":"/2022/01/07/%E4%BD%BF%E7%94%A8scp%E5%91%BD%E4%BB%A4%E5%AE%9E%E7%8E%B0%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8A%E4%BC%A0%E4%B8%8B%E8%BD%BD/"},{"title":"åå°è¿è¡Œ&#x2F;è¿›ç¨‹æŸ¥çœ‹åŠç»ˆæ­¢","text":"åå°è¿è¡Œ nohup ç”¨é€”ï¼šä¸æŒ‚æ–­åœ°è¿è¡Œå‘½ä»¤ã€‚ è¯­æ³•ï¼šnohup Command [ Arg â€¦ ] [ &amp; ] æ— è®ºæ˜¯å¦å°† nohup å‘½ä»¤çš„è¾“å‡ºé‡å®šå‘åˆ°ç»ˆç«¯ï¼Œè¾“å‡ºéƒ½å°†é™„åŠ åˆ°å½“å‰ç›®å½•çš„ nohup.out æ–‡ä»¶ä¸­ã€‚ å¦‚æœå½“å‰ç›®å½•çš„ nohup.out æ–‡ä»¶ä¸å¯å†™ï¼Œè¾“å‡ºé‡å®šå‘åˆ° $HOME/nohup.out æ–‡ä»¶ä¸­ã€‚ å¦‚æœæ²¡æœ‰æ–‡ä»¶èƒ½åˆ›å»ºæˆ–æ‰“å¼€ä»¥ç”¨äºè¿½åŠ ï¼Œé‚£ä¹ˆ Command å‚æ•°æŒ‡å®šçš„å‘½ä»¤ä¸å¯è°ƒç”¨ã€‚ é€€å‡ºçŠ¶æ€ï¼šè¯¥å‘½ä»¤è¿”å›ä¸‹åˆ—å‡ºå£å€¼ï¼š 126 å¯ä»¥æŸ¥æ‰¾ä½†ä¸èƒ½è°ƒç”¨ Command å‚æ•°æŒ‡å®šçš„å‘½ä»¤ã€‚ 127 nohup å‘½ä»¤å‘ç”Ÿé”™è¯¯æˆ–ä¸èƒ½æŸ¥æ‰¾ç”± Command å‚æ•°æŒ‡å®šçš„å‘½ä»¤ã€‚ å¦åˆ™ï¼Œnohup å‘½ä»¤çš„é€€å‡ºçŠ¶æ€æ˜¯ Command å‚æ•°æŒ‡å®šå‘½ä»¤çš„é€€å‡ºçŠ¶æ€ã€‚ &amp; ç”¨é€”ï¼šåœ¨åå°è¿è¡Œ ä¸€èˆ¬ä¸¤ä¸ªä¸€èµ·ç”¨ nohup command &amp; eg: 12# --run--nohup python3 index.py &amp; crontab 12# --run--crontab -e crontab æ–‡ä»¶çš„æ ¼å¼ï¼š{minute} {hour} {day-of-month} {month} {day-of-week} {full-path-to-shell-script}o minute: åŒºé—´ä¸º 0 â€“ 59o hour: åŒºé—´ä¸º0 â€“ 23o day-of-month: åŒºé—´ä¸º0 â€“ 31o month: åŒºé—´ä¸º1 â€“ 12. 1 æ˜¯1æœˆ. 12æ˜¯12æœˆ.o Day-of-week: åŒºé—´ä¸º0 â€“ 7. å‘¨æ—¥å¯ä»¥æ˜¯0æˆ–7. Crontab ç¤ºä¾‹ åœ¨ 12:01 a.m è¿è¡Œï¼Œå³æ¯å¤©å‡Œæ™¨è¿‡ä¸€åˆ†é’Ÿã€‚è¿™æ˜¯ä¸€ä¸ªæ°å½“çš„è¿›è¡Œå¤‡ä»½çš„æ—¶é—´ï¼Œå› ä¸ºæ­¤æ—¶ç³»ç»Ÿè´Ÿè½½ä¸å¤§ã€‚ 1 0 * * * /root/bin/backup.sh æ¯ä¸ªå·¥ä½œæ—¥(Mon â€“ Fri) 11:59 p.m éƒ½è¿›è¡Œå¤‡ä»½ä½œä¸šã€‚ 59 11 * * 1,2,3,4,5 /root/bin/backup.sh ä¸‹é¢ä¾‹å­ä¸ä¸Šé¢çš„ä¾‹å­æ•ˆæœä¸€æ ·ï¼š 59 11 * * 1-5 /root/bin/backup.sh æ¯5åˆ†é’Ÿè¿è¡Œä¸€æ¬¡å‘½ä»¤ */5 * * * * /root/bin/check-status.sh æ¯ä¸ªæœˆçš„ç¬¬ä¸€å¤© 1:10 p.m è¿è¡Œ 10 13 1 * * /root/bin/full-backup.sh æ¯ä¸ªå·¥ä½œæ—¥ 11 p.m è¿è¡Œã€‚ 0 23 * * 1-5 /root/bin/incremental-backup.sh Crontab é€‰é¡¹ä»¥ä¸‹æ˜¯ crontab çš„æœ‰æ•ˆé€‰é¡¹: o crontab â€“e : ä¿®æ”¹ crontab æ–‡ä»¶. å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ä¼šè‡ªåŠ¨åˆ›å»ºã€‚o crontab â€“l : æ˜¾ç¤º crontab æ–‡ä»¶ã€‚o crontab -r : åˆ é™¤ crontab æ–‡ä»¶ã€‚o crontab -ir : åˆ é™¤ crontab æ–‡ä»¶å‰æé†’ç”¨æˆ·ã€‚ ä»¥ä¸Šå°±æ˜¯crontabå‘½ä»¤çš„å…·ä½“ä½¿ç”¨æ–¹æ³•äº†ã€‚ è¿›ç¨‹æŸ¥çœ‹åŠç»ˆæ­¢ jobs - l 12# --run--jobs -l jobså‘½ä»¤åªçœ‹å½“å‰ç»ˆç«¯ç”Ÿæ•ˆçš„ï¼Œå…³é—­ç»ˆç«¯åï¼Œåœ¨å¦ä¸€ä¸ªç»ˆç«¯jobså·²ç»æ— æ³•çœ‹åˆ°åå°è·‘å¾—ç¨‹åºäº†ï¼Œæ­¤æ—¶åˆ©ç”¨psï¼ˆè¿›ç¨‹æŸ¥çœ‹å‘½ä»¤ï¼‰ ps -ef 12# --run--ps -aux|grep chat.js a: æ˜¾ç¤ºæ‰€æœ‰ç¨‹åº u: ä»¥ç”¨æˆ·ä¸ºä¸»çš„æ ¼å¼æ¥æ˜¾ç¤º x: æ˜¾ç¤ºæ‰€æœ‰ç¨‹åºï¼Œä¸ä»¥ç»ˆç«¯æœºæ¥åŒºåˆ† æ³¨ï¼š ç”¨ps -def | grepæŸ¥æ‰¾è¿›ç¨‹å¾ˆæ–¹ä¾¿ï¼Œæœ€åä¸€è¡Œæ€»æ˜¯ä¼šgrepè‡ªå·± ç”¨grep -vå‚æ•°å¯ä»¥å°†grepå‘½ä»¤æ’é™¤æ‰ 12# --run--ps -aux|grep chat.js| grep -v grep å†ç”¨awkæå–ä¸€ä¸‹è¿›ç¨‹ID 12# --run--ps -aux|grep chat.js| grep -v grep | awk '{print $2}' å¦‚æœæŸä¸ªè¿›ç¨‹èµ·ä¸æ¥ï¼Œå¯èƒ½æ˜¯æŸä¸ªç«¯å£è¢«å ç”¨ æŸ¥çœ‹ä½¿ç”¨æŸç«¯å£çš„è¿›ç¨‹ 123# --run--lsof -i:8090netstat -ap|grep 8090 æŸ¥çœ‹åˆ°è¿›ç¨‹idä¹‹åï¼Œä½¿ç”¨netstatå‘½ä»¤æŸ¥çœ‹å…¶å ç”¨çš„ç«¯å£ 12# --run--netstat -nap|grep 7779 ä½¿ç”¨killæ€æ‰è¿›åŸåå†å¯åŠ¨ ç»ˆæ­¢åå°è¿è¡Œçš„è¿›ç¨‹ 12345# --run--kill -9 è¿›ç¨‹å·pkill è¿›ç¨‹å·/è¿›ç¨‹åps -ef | grep fileName.py | grep -v grep | cut -c 9-16 | xargs kill -9ps -aux|grep lask.py| grep -v grep | awk '{print $2}'","link":"/2022/01/07/%E5%90%8E%E5%8F%B0%E8%BF%90%E8%A1%8C-%E8%BF%9B%E7%A8%8B%E6%9F%A5%E7%9C%8B%E5%8F%8A%E7%BB%88%E6%AD%A2/"},{"title":"å¿«é€Ÿæ’åºçš„å››ç§pythonå®ç°","text":"å¿«é€Ÿæ’åºç®—æ³•ï¼Œç®€ç§°å¿«æ’ï¼Œæ˜¯æœ€å®ç”¨çš„æ’åºç®—æ³•ï¼Œæ²¡æœ‰ä¹‹ä¸€ï¼Œå„å¤§è¯­è¨€æ ‡å‡†åº“çš„æ’åºå‡½æ•°ä¹ŸåŸºæœ¬éƒ½æ˜¯åŸºäºå¿«æ’å®ç°çš„ã€‚ æœ¬æ–‡ç”¨pythonè¯­è¨€ä»‹ç»å››ç§ä¸åŒçš„å¿«æ’å®ç°ã€‚ ä¸€è¡Œä»£ç å®ç°çš„ç®€æ´ç‰ˆæœ¬ 1quick_sort = lambda array: array if len(array) &lt;= 1 else quick_sort([item for item in array[1:] if item &lt;= array[0]]) + [array[0]] + quick_sort([item for item in array[1:] if item &gt; array[0]]) ç½‘ä¸Šå¸¸è§çš„å¿«æ’å®ç° 12345678910111213141516def quick_sort(array, left, right): if left &gt;= right: return low = left high = right key = array[low] while left &lt; right: while left &lt; right and array[right] &gt; key: right -= 1 array[left] = array[right] while left &lt; right and array[left] &lt;= key: left += 1 array[right] = array[left] array[right] = key quick_sort(array, low, left - 1) quick_sort(array, left + 1, high) ç”±äºå¿«æ’æ˜¯åŸåœ°æ’åºï¼Œå› æ­¤ä¸éœ€è¦è¿”å›arrayã€‚ arrayå¦‚æœæ˜¯ä¸ªåˆ—è¡¨çš„è¯ï¼Œå¯ä»¥é€šè¿‡len(array)æ±‚å¾—é•¿åº¦ï¼Œä½†æ˜¯åè¾¹é€’å½’è°ƒç”¨çš„æ—¶å€™å¿…é¡»ä½¿ç”¨åˆ†ç‰‡ï¼Œè€Œåˆ†ç‰‡æ‰§è¡Œçš„åŸåˆ—è¡¨çš„å¤åˆ¶æ“ä½œï¼Œè¿™æ ·å°±è¾¾ä¸åˆ°åŸåœ°æ’åºçš„ç›®çš„äº†ï¼Œæ‰€ä»¥è¿˜æ˜¯è¦ä¼ ä¸Šè¾¹ç•Œå’Œä¸‹è¾¹ç•Œçš„ã€‚ ã€Šç®—æ³•å¯¼è®ºã€‹ä¸­çš„å¿«æ’ç¨‹åº 123456789101112131415def quick_sort(array, l, r): if l &lt; r: q = partition(array, l, r) quick_sort(array, l, q - 1) quick_sort(array, q + 1, r) def partition(array, l, r): x = array[r] i = l - 1 for j in range(l, r): if array[j] &lt;= x: i += 1 array[i], array[j] = array[j], array[i] array[i + 1], array[r] = array[r], array[i+1] return i + 1 è¿™ä¸ªç‰ˆæœ¬è·Ÿä¸Šä¸ªç‰ˆæœ¬çš„ä¸åŒåœ¨äºåˆ†ç‰‡è¿‡ç¨‹ä¸åŒï¼Œåªç”¨äº†ä¸€å±‚å¾ªç¯ï¼Œå¹¶ä¸”ä¸€è¶Ÿå°±å®Œæˆåˆ†ç‰‡ï¼Œç›¸æ¯”ä¹‹ä¸‹ä»£ç è¦ç®€æ´çš„å¤šäº†ã€‚ ç”¨æ ˆå®ç°éé€’å½’çš„å¿«æ’ç¨‹åº å…ˆè¯´ä¸¤å¥é¢˜å¤–è¯ï¼Œä¸€èˆ¬æ„ä¹‰ä¸Šçš„æ ˆæœ‰ä¸¤å±‚å«ä¹‰ï¼Œä¸€å±‚æ˜¯åè¿›å…ˆå‡ºçš„æ•°æ®ç»“æ„æ ˆï¼Œä¸€å±‚æ˜¯æŒ‡å‡½æ•°çš„å†…å­˜æ ˆï¼Œå½’æ ¹ç»“åº•ï¼Œå‡½æ•°çš„å†…å­˜æ ˆçš„ç»“æ„å°±æ˜¯ä¸€ä¸ªåè¿›å…ˆå‡ºçš„æ ˆã€‚æ±‡ç¼–ä»£ç ä¸­ï¼Œè°ƒç”¨ä¸€ä¸ªå‡½æ•°çš„æ—¶å€™ï¼Œä¿®æ”¹çš„ä¹Ÿæ˜¯å †æ ˆæŒ‡é’ˆå¯„å­˜å™¨ESPï¼Œè¯¥å¯„å­˜å™¨ä¿å­˜çš„æ˜¯å‡½æ•°å±€éƒ¨æ ˆçš„æ ˆé¡¶ï¼Œå¦å¤–ä¸€ä¸ªå¯„å­˜å™¨EBPä¿å­˜çš„æ˜¯æ ˆåº•ã€‚ä¸çŸ¥é“ä¸æ ˆå­˜å‚¨ç©ºé—´ç›¸å¯¹çš„å †å­˜å‚¨ç©ºé—´ï¼Œå…¶ç»„ç»‡ç»“æ„æ˜¯å¦ä¹Ÿæ˜¯ä¸€ä¸ªå®Œå…¨äºŒå‰æ ‘å‘¢ï¼Ÿé«˜çº§è¯­è¨€å°†é€’å½’è½¬æ¢ä¸ºè¿­ä»£ï¼Œç”¨çš„ä¹Ÿæ˜¯æ ˆï¼Œéœ€è¦è€ƒè™‘ä¸¤ä¸ªé—®é¢˜:1ï¼‰æ ˆé‡Œè¾¹ä¿å­˜ä»€ä¹ˆï¼Ÿ2ï¼‰è¿­ä»£ç»“æŸçš„æ¡ä»¶æ˜¯ä»€ä¹ˆï¼Ÿæ ˆé‡Œè¾¹ä¿å­˜çš„å½“ç„¶æ˜¯éœ€è¦è¿­ä»£çš„å‡½æ•°å‚æ•°ï¼Œç»“æŸæ¡ä»¶ä¹Ÿæ˜¯è·Ÿéœ€è¦è¿­ä»£çš„å‚æ•°æœ‰å…³ã€‚å¯¹äºå¿«é€Ÿæ’åºæ¥è¯´ï¼Œè¿­ä»£çš„å‚æ•°æ˜¯æ•°ç»„çš„ä¸Šè¾¹ç•Œlowå’Œä¸‹è¾¹ç•Œhighï¼Œè¿­ä»£ç»“æŸçš„æ¡ä»¶æ˜¯low == highã€‚ 12345678910111213141516171819def quick_sort(array, l, r): if l &gt;= r: return stack = [] stack.append(l) stack.append(r) while stack: low = stack.pop(0) high = stack.pop(0) if high - low &lt;= 0: continue x = array[high] i = low - 1 for j in range(low, high): if array[j] &lt;= x: i += 1 array[i], array[j] = array[j], array[i] array[i + 1], array[high] = array[high], array[i + 1] stack.extend([low, i, i + 2, high]) å¦å¤–ï¼Œå½“æ•°ç»„ä¸‹æ ‡ä¸º-1æ—¶ï¼ŒC++ã€Javaç­‰è¯­è¨€ä¸­ä¼šæŠ¥é”™ï¼Œä½†pythonä¸­è®¿é—®çš„æ˜¯æœ€åä¸€ä¸ªå…ƒç´ ï¼Œæ‰€ä»¥å¦‚æœç¨‹åºå†™é”™äº†ï¼Œå¯èƒ½å…¶ä»–è¯­è¨€ä¼šæŠ¥é”™ï¼Œä½†pythonä¼šè¾“å‡ºä¸€ä¸ªé”™è¯¯çš„ç»“æœã€‚","link":"/2022/01/18/%E5%BF%AB%E9%80%9F%E6%8E%92%E5%BA%8F%E7%9A%84%E5%9B%9B%E7%A7%8Dpython%E5%AE%9E%E7%8E%B0/"},{"title":"æ¶ˆè´¹KafkaåŒæ­¥åˆ°Hologres(ä¸€)","text":"KafkaConsumerå†…ç½‘è¿æ¥æ–¹å¼ï¼š12345678from kafka import KafkaConsumerself.consumer = KafkaConsumer(bootstrap_servers=kafkaConfig['host'], group_id=kafkaConfig['groupId'], api_version=(0, 10, 2), session_timeout_ms=25000, max_poll_records=1000, fetch_max_bytes=1 * 1024 * 1024) å¤–ç½‘è¿æ¥æ–¹å¼ï¼š123456789101112from kafka import KafkaConsumerself.consumer = KafkaConsumer(bootstrap_servers=kafkaConfig['bootstrap_servers'], group_id=consumer_id, sasl_mechanism=&quot;PLAIN&quot;, ssl_context=context, security_protocol='SASL_SSL', api_version=(0, 10), sasl_plain_username=kafkaConfig['sasl_plain_username'], sasl_plain_password=kafkaConfig['sasl_plain_password'], session_timeout_ms=25000, max_poll_records=10) Offsetkafkaé«˜ååé‡çš„ä¿è¯æ˜¯Partitionæ˜¯é¡ºåºå†™ç£ç›˜ï¼ŒåŒæ ·æ¶ˆè´¹ä¹Ÿæ˜¯é¡ºåºçš„ï¼Œoffsetç»´æŠ¤äº†ä¸€ä¸ªgroupçš„æ¶ˆè´¹è€…åœ¨å½“å‰partitionæ¶ˆè´¹çš„æ•°æ®ä½ç½®ã€‚ å½“ä¸€ä¸ªconsumerå¯åŠ¨åï¼Œä¼šæŸ¥è¯¢æœåŠ¡ç«¯çš„offsetä½œä¸ºæœ¬åœ°offset è¿è¡Œä¸­pollæ•°æ®ä½¿ç”¨çš„æ˜¯æœ¬åœ°offsetï¼Œä¸å†æŸ¥è¯¢server æ¯pollå®Œä¸€æ‰¹æ•°æ®ï¼Œè‡ªåŠ¨æ›´æ–°æœ¬åœ°offset serverç«¯ä¹Ÿä¼šç»´æŠ¤ä¸€ä¸ªoffsetï¼Œæ–°ç‰ˆkafka offsetæ˜¯ç»´æŠ¤åœ¨ä¸€ä¸ªtopicä¸­ï¼Œæ—§ç‰ˆç»´æŠ¤åœ¨zookeeper æäº¤offsetæ˜¯æŒ‡ï¼šä½¿ç”¨æœ¬åœ°çš„offset/æŒ‡å®šçš„offset å»æ›´æ–°serverç«¯çš„offsetï¼Œä½†æ˜¯æœ¬åœ°offsetä¸ä¼šæ”¹å˜ è‡ªåŠ¨æäº¤è‡ªåŠ¨æäº¤ç­–ç•¥ä¸‹ï¼Œæ˜¯æ¯éš”æŒ‡å®šæ—¶é—´ï¼Œç”±kafka-clientsè‡ªåŠ¨æäº¤æœ¬åœ°ç»´æŠ¤çš„offsetï¼Œé»˜è®¤æœ¬åœ°offset=pollçš„æ•°é‡+1ã€‚ï¼ˆæœ¬åœ°offsetå¯ä»¥é€šè¿‡seekæ–¹æ³•ä¿®æ”¹ï¼‰ ä½†æ˜¯ä¼šå‡ºç°æ•°æ®ä¸¢å¤±çš„æƒ…å†µï¼Œæ¯”å¦‚polläº†ä¸€æ‰¹æ•°æ®æ²¡æœ‰å¤„ç†å®Œï¼Œä½†æ˜¯åˆ°æ—¶é—´äº†å·²ç»æäº¤äº†offsetï¼Œç„¶åç¨‹åºç»ˆæ­¢äº†ï¼Œä¸‹æ¬¡å¯åŠ¨ä¼šä»æ–°çš„offsetâ€™å¯åŠ¨ï¼Œæ²¡æœ‰å¤„ç†çš„æ•°æ®ä¸¢å¤±äº†ã€‚ 123self.enable_auto_commit=True,self.auto_commit_interval_ms=1000,self.consumer_timeout_ms=2000, æ‰‹åŠ¨æäº¤ ä¸æŒ‡å®šoffsetï¼šåŒä¸Šï¼Œä¹Ÿæ˜¯æäº¤æœ¬åœ°ç»´æŠ¤çš„offsetï¼Œé»˜è®¤æœ¬åœ°offset=pollçš„æ•°é‡+1ã€‚ è¿™ç§æ¨¡å¼ä¸‹ï¼Œæ•°æ®å¤„ç†å®Œæ¯•ï¼ˆä¿å­˜/ä¸¢å¼ƒï¼‰åå†æ‰‹åŠ¨æäº¤ï¼Œè§£å†³äº†è‡ªåŠ¨æ¨¡å¼ä¸‹çš„æ•°æ®ä¸¢å¤±é—®é¢˜ï¼Œä½†æ˜¯å¯èƒ½å­˜åœ¨æ¶ˆè´¹å®Œçš„æ•°æ®ï¼Œoffsetæ²¡æœ‰æäº¤æˆåŠŸï¼Œé‡å¤æ¶ˆè´¹æ•°æ®çš„é—®é¢˜ï¼ˆå¯ä»¥é€šè¿‡æ•°æ®åº“äº‹åŠ¡è§£å†³ï¼‰ã€‚ æŒ‡å®šoffsetï¼šæ›´æ–°serverç«¯offsetä¸ºæŒ‡å®šå€¼ï¼Œä½†æ˜¯æœ¬åœ°offsetä¸ä¼šæ›´æ–°ï¼Œæ‰€ä»¥åœ¨consumeræ²¡æœ‰é‡å¯çš„æƒ…å†µä¸‹ï¼Œæ˜¯ä¸ä¼šæ¶ˆè´¹åˆ°é‡å¤æ•°æ®ã€‚ 12self.enable_auto_commit=False, # å…³é—­è‡ªåŠ¨æäº¤self.consumer_timeout_ms=2000, 1234# è·å–å½“å‰åç§»é‡now_offset = message.offset # æäº¤åç§»é‡ï¼Œnow_offset+1çš„åŸå› æ˜¯å› ä¸ºæˆ‘å‘ç°å¦‚æœä¸åŠ 1ï¼Œä¸‹æ¬¡æ¶ˆè´¹ä¼šä»ä¸Šæ¬¡æ¶ˆè´¹æœ€åä¸€æ¡æ•°æ®å¼€å§‹ï¼Œé‡å¤æ¶ˆè´¹self.consumer.commit(offsets={tp:(OffsetAndMetadata(now_offset+1, None))}) æ¶ˆè´¹æ–¹å¼Kafkaæ¶ˆè´¹æœ‰ä¸¤ç§æŒ‡å®štopicçš„æ–¹å¼ï¼šsubscribeå’Œassignï¼Œä¸¤ç§æ–¹å¼ä¸»è¦åŒºåˆ«åœ¨äºpartitionçš„åˆ†é…ï¼Œå‰è€…æ˜¯ç”±kafka-clientsåˆ†é…çš„ï¼ˆé«˜çº§æ¶ˆè´¹ï¼‰ï¼Œè€Œåè€…æ˜¯æˆ‘ä»¬æ‰‹åŠ¨æŒ‡å®šçš„ï¼ˆä½çº§æ¶ˆè´¹ï¼‰ã€‚ æ³¨æ„ï¼šConsumerçº¿ç¨‹ä¸å®‰å…¨ï¼Œä¸èƒ½å¤šçº¿ç¨‹å…±ç”¨ã€‚ é«˜çº§æ¶ˆè´¹å¯¹åº”äºKafkaConsumer.subscribe()æ–¹æ³• 12# self.consumer.subscribe([confKafka['topic_name']])self.consumer.subscribe([confKafka['topic_name']]) ä½¿ç”¨é«˜çº§æ¶ˆè´¹æ—¶ï¼Œå‡å®šï¼Œ1-Nä¸ªconsumerï¼Œå±äºåŒä¸€ä¸ªgroupã€‚æ ¹æ®è®¢é˜…çš„consumerçš„ä¸ªæ•°ï¼Œç”±kafka-clinetsæ ¹æ®æŒ‡å®šçš„åˆ†é…ç­–ç•¥åˆ†é…æ¯ä¸ªconsumeræ¶ˆè´¹çš„partitionã€‚æ³¨æ„ï¼šå¿…é¡»ä½¿ç”¨åˆç†çš„åˆ†é…ç­–ç•¥ï¼Œå¦åˆ™å¯èƒ½å‡ºç°ä¸€äº›consumeræ²¡æœ‰åˆ†é…partitionçš„æƒ…å†µã€‚ è‹¥N&gt;partition num(æ‰€æœ‰topicçš„partitionæ€»å’Œ), åˆ™ä¸€äº›consumerä¸ä¼šè¢«åˆ†é…partition è‹¥N&lt;partition num,åˆ™æŸäº›consumerä¼šæ¶ˆè´¹å¤šä¸ªpartition å½“æ¶ˆè´¹å¤šä¸ªpartitionæ—¶ï¼Œæ¶ˆè´¹æ¯ä¸ªåˆ†åŒºå†…çš„æ¶ˆæ¯æ˜¯æœ‰åºçš„ï¼Œä½†æ¶ˆè´¹å¤šä¸ªåˆ†åŒºä¹‹é—´çš„æ¶ˆæ¯æ˜¯æ— åºçš„ï¼ˆå¯ä»¥åœ¨æ¶ˆè´¹è®°å½•ä¸­è·å¾—å½“å‰è®°å½•çš„partitionï¼‰ partitionåˆ†é…ç­–ç•¥ range: å¾—åˆ°topic-partitionså…³ç³»ï¼Œå¾—åˆ°topic-consumerså…³ç³»ï¼Œç„¶åï¼ŒæŒ‰ç…§topicè¿›è¡Œåˆ†é…ï¼Œå³topicçš„æ‰€æœ‰partitionæŒ‰é¡ºåºåˆ†é…åˆ°å…¶æ‰€æœ‰çš„consumerä¸Šï¼Œä¸¾ä¾‹ï¼štopicA-3partition, topicB-1partition, 4 consumers, è¿‡ç¨‹æ˜¯ï¼ŒAçš„3ä¸ªpartitionåˆ†é…åˆ°consumer1-3ï¼ŒBçš„1ä¸ªpartitionåˆ†é…åˆ°consumer1ï¼Œconsumer4ç©ºé—²ï¼Œæ‰€ä»¥ä½¿ç”¨çš„æœ€å¤§çº¿ç¨‹æ•°=max(topic*partition) roundrobinï¼štopicså’Œpatitionç»„åˆï¼Œä¸Šè¿°ä¾‹å­ï¼Œå°±æ˜¯ta-0,ta-1,ta-2,tb-0,ç„¶åå››ä¸ªå–hashcodeå¾—åˆ°é¡ºåºï¼Œç„¶åæŒ¨ä¸ªåˆ†é…åˆ°consumerä¸Šï¼ˆè¦æ±‚ï¼šæ¯ä¸€ä¸ªconsumeræ¶ˆè´¹çš„topicsæœ‰ç›¸åŒçš„streams&amp;&amp;è¿™ä¸ªæ¶ˆè´¹ç»„ä¸­æ¯ä¸ªconsumeræ¶ˆè´¹çš„topicså¿…é¡»å®Œå…¨ç›¸åŒï¼‰ Reblanceè®¢é˜…æ¨¡å¼ä¸‹ï¼Œæ¯åŠ å…¥æˆ–è€…ç¦»å¼€ä¸€ä¸ªconsumerï¼Œéƒ½ä¼šè§¦å‘consumer reblanceï¼Œé‡æ–°ä¸ºæ¯ä¸ªæ¶ˆè´¹è€…åˆ†é…partitionã€‚ reblanceçš„è¿‡ç¨‹å‘ç”Ÿäº†ä»€ä¹ˆï¼ŸæŸ¥çœ‹kafka-clientsæºç å¯ä»¥å‘ç°ï¼š AbstractCoordinator æœ‰è¯¦ç»†è¯´æ˜è°ƒç”¨subscribeæ–¹æ³•å‘ç”Ÿäº†ä»¥ä¸‹çš„äº‹è¯· consumeræ³¨å†Œåˆ°åˆ°æœåŠ¡ç«¯ coordinatorï¼ˆserverç«¯ç»´æŠ¤çš„ä¸€ä¸ªæœåŠ¡ï¼‰æŸ¥æ‰¾æ‰€æœ‰çš„è¯¥ç»„consumerï¼Œé€‰å–leander å¦‚æœauto commitä¸ºtrueï¼Œæ‰€æœ‰çš„consumeræäº¤æœ¬åœ°offsetåˆ°æœåŠ¡ç«¯ï¼›ä¸ºfalseåˆ™ä¸æäº¤ leaderé€šè¿‡coordinatorè·å–æœåŠ¡ç«¯æ‰€æœ‰çš„partitionå’Œoffsetï¼Œå¹¶ä½¿ç”¨ç­–ç•¥é‡æ–°åˆ†é…partitionï¼Œç»“æœè¿”å›ç»™coordinatorï¼Œcoordinatorä¸‹å‘åˆ†é…ç»“æœåˆ°æ‰€æœ‰consumerï¼ˆå³jonå’Œleaveçš„reblanceï¼‰ã€‚ æ‰€ä»¥é«˜çº§æ¶ˆè´¹è€…é›†ç¾¤æ—¶ï¼Œæ–°åŠ å…¥çš„consumerï¼Œå¦‚æœæ˜¯auto-commitåˆ™ä¼šæäº¤offsetï¼Œè‹¥æœªå¤„ç†å®Œå¯èƒ½ä¼šä¸¢å¤±æ•°æ®ï¼›å¦åˆ™ä¸æäº¤ï¼Œä¼šé‡å¤æ¶ˆè´¹æ•°æ®ã€‚ç¦»å¼€consumerï¼Œè‹¥æœªæäº¤offsetç¦»å¼€ï¼Œåˆ™ä¼šé‡å¤æ¶ˆè´¹æ•°æ®ï¼›è‹¥è‡ªåŠ¨æäº¤äº†ä½†æ˜¯æœªæ¶ˆè´¹ï¼Œåˆ™ä¼šä¸¢å¤±æ•°æ®ã€‚ ä½çº§æ¶ˆè´¹å¯¹åº”äºKafkaConsumer.assign()æ–¹æ³•ï¼ŒæŒ‡å®šTopicPartitionçš„é›†åˆ 12self.partition = TopicPartition(topic=myTopic, partition=myPartition)self.consumer.assign([self.partition]) ä½¿ç”¨ä½çº§æ¶ˆè´¹æ—¶ï¼Œç›´æ¥æŒ‡å®šconsumeræ¶ˆè´¹æŸä¸ªtopicçš„æŸä¸ªpartitionï¼Œä¸å†ç”±kafka-clientsåˆ†é…ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œæ˜¯å¯ä»¥å¤šä¸ªåŒç»„æ¶ˆè´¹è€…æ¶ˆè´¹åŒä¸€ä¸ªpartitionçš„ã€‚ æ‰€ä»¥å½“åŒä¸€ä¸ªæ¶ˆè´¹ç»„æŒ‡å®šé‡å¤çš„partitionæ—¶ï¼Œä¼šæ¶ˆè´¹åˆ°é‡å¤çš„æ•°æ®(å®Œå…¨é‡å¤çš„æ•°æ®ï¼Œå› ä¸ºpollçš„offsetæ˜¯æœ¬åœ°ç»´æŠ¤çš„)ï¼Œä½†æ˜¯serverç«¯åªæœ‰ä¸€ä¸ªoffsetï¼serverçš„offsetè¢«ä¸¤ä¸ªconsumeræ›´æ–°ï¼Œä¼šå‡ºç°å†²çªå’Œé”™ä¹±ï¼Œè¿™ç§æ¨¡å¼ä¸‹ï¼Œéœ€è¦å¼€å‘è€…è‡ªå·±ä¿è¯åŒä¸€ä¸ªæ¶ˆè´¹ç»„çš„æ¶ˆè´¹ç€å…·æœ‰ä¸é‡å¤çš„partitionã€‚ é«˜çº§orä½çº§ï¼Ÿå¦‚ä½•æŠ‰æ‹©ï¼Œä¸»è¦å–å†³äºå¤æ‚æ€§å’Œæ•°æ®ä¸€è‡´æ€§çš„å–èˆï¼Œå³reblanceå¸¦æ¥çš„å½±å“å’Œæ‰‹åŠ¨åˆ†é…å¸¦æ¥çš„å¤æ‚çš„å–èˆã€‚ æ•°æ®ä¸¢å¤±/é‡å¤æ¶ˆè´¹ é«˜çº§æ¶ˆè´¹partitionçš„åˆ†é…æ˜¯ç”±kafka-clinetså®Œæˆçš„ï¼Œä½†æ˜¯ä¼šæŸ¥è¯¢serverç«¯çš„ä¿¡æ¯ï¼Œæ‰€ä»¥é›†ç¾¤ç¯å¢ƒä¸‹ï¼Œå½“æ²¡æœ‰æŒ‡å®špartitionæ—¶ï¼Œæ¯åŠ å…¥/ç¦»å¼€ä¸€ä¸ªæ¶ˆè´¹è€…ï¼Œkafka-clientséƒ½ä¼šé‡æ–°å¹³è¡¡partitionçš„åˆ†é…ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œå¦‚æœæœ‰æ¶ˆè´¹å®Œæˆä½†æ˜¯æ²¡æœ‰æäº¤çš„offsetï¼Œreblanceæ—¶åˆ™ä¼šé€ æˆæ•°æ®çš„é‡å¤æ¶ˆè´¹æˆ–è€…æ•°æ®ä¸¢å¤±ï¼ˆå…·ä½“æ˜¯å“ªç§æƒ…å†µï¼Œè¦çœ‹offsetçš„æäº¤ç­–ç•¥ï¼‰ã€‚ä½çº§æ¶ˆè´¹åˆ™ä¸ä¼šå‘ç”Ÿreblanceï¼ æ³¨æ„ ï¼šSpring-kafkaå¤šçº¿ç¨‹æ¶ˆè´¹çš„é…ç½®ä¸‹ï¼ŒæŒ‡å®štopicå’Œpartitionæ—¶ï¼Œä¹Ÿæ˜¯ä½çº§æ¶ˆè´¹ï¼Œå…¶çº¿ç¨‹å’Œpartitionçš„åˆ†é…ç­–ç•¥è§åç»­spring-kafkaçš„æ•™ç¨‹ã€‚ reblanceå½±å“æ€§èƒ½ æ¯æ¬¡reblanceéƒ½è¦é‡æ–°åˆ†é…ï¼Œå¦‚æœpartitionæ¯”è¾ƒå¤šçš„æƒ…å†µä¸‹ï¼Œé‡æ–°åˆ†é…å°†ä¼šæ¶ˆè€—å¤§é‡çš„æ—¶é—´ã€‚ ä½çº§æ¶ˆè´¹æ—¶çš„é«˜å¯ç”¨ å¦‚æœä½¿ç”¨ä½çº§æ¶ˆè´¹ï¼Œå½“ä¸€ä¸ªconsumeré€€å‡ºæ—¶ï¼Œå…¶partitionä¸ä¼šå†åˆ†é…ç»™å…¶ä»–æ¶ˆè´¹è€…ï¼Œæ•°æ®å°†ä¼šå †ç§¯åœ¨kafkaä¸­ï¼æ‰€ä»¥åŠ¡å¿…è¦ä¿è¯é€€å‡ºçš„æ¶ˆè´¹è€…èƒ½é‡æ–°è¿è¡Œã€‚","link":"/2022/01/08/%E6%B6%88%E8%B4%B9Kafka%E5%90%8C%E6%AD%A5%E5%88%B0Hologres-%E4%B8%80/"},{"title":"æ¶ˆè´¹KafkaåŒæ­¥åˆ°Hologres(ä¸‰)","text":"Redisç¼“å­˜æœºåˆ¶Redisæ˜¯ä¸€æ¬¾å†…å­˜é«˜é€Ÿç¼“å­˜æ•°æ®åº“ï¼› æ•°æ®æ¨¡å‹ä¸ºï¼škey - valueï¼Œéå…³ç³»å‹æ•°æ®åº“ä½¿ç”¨çš„å­˜å‚¨æ•°æ®çš„æ ¼å¼ã€‚ 123456# Redisè¿æ¥self.re_queue = redis.StrictRedis(host=confRedis['host'], port=confRedis['port'], password=confRedis['passwd'], db=confRedis['db'], decode_responses=True) 123456# Redisè¿æ¥æ± self.pool = redis.ConnectionPool(host=self.db['host'], port=self.db['port'], db=self.db['db'], password=self.db['passwd'])self.re_queue = redis.Redis(connection_pool=self.pool) Stringï¼ˆå­—ç¬¦ä¸²ï¼‰string æ˜¯ redis æœ€åŸºæœ¬çš„ç±»å‹ï¼Œä½ å¯ä»¥ç†è§£æˆä¸ Memcached ä¸€æ¨¡ä¸€æ ·çš„ç±»å‹ï¼Œä¸€ä¸ª key å¯¹åº”ä¸€ä¸ª valueã€‚ string ç±»å‹æ˜¯äºŒè¿›åˆ¶å®‰å…¨çš„ã€‚æ„æ€æ˜¯ redis çš„ string å¯ä»¥åŒ…å«ä»»ä½•æ•°æ®ã€‚æ¯”å¦‚jpgå›¾ç‰‡æˆ–è€…åºåˆ—åŒ–çš„å¯¹è±¡ã€‚ string ç±»å‹æ˜¯ Redis æœ€åŸºæœ¬çš„æ•°æ®ç±»å‹ï¼Œstring ç±»å‹çš„å€¼æœ€å¤§èƒ½å­˜å‚¨ 512MBã€‚ 1234567# outputself.re_queue.set(keyName,data)self.re_queue.setex(keyName, time, data)self.re_queue.mset()# inputresult = self.re_queue.get(keyName) Hashï¼ˆå“ˆå¸Œï¼‰Redis hash æ˜¯ä¸€ä¸ªé”®å€¼(key=&gt;value)å¯¹é›†åˆã€‚ Redis hash æ˜¯ä¸€ä¸ª string ç±»å‹çš„ field å’Œ value çš„æ˜ å°„è¡¨ï¼Œhash ç‰¹åˆ«é€‚åˆç”¨äºå­˜å‚¨å¯¹è±¡ã€‚ 1234567# outputself.re_queue.hset(name, key, value)self.re_queue.expire(name, time)# inputresult = self.re_queue.hget(name, key)result = self.re_queue.hvals(name) Listï¼ˆåˆ—è¡¨ï¼‰Redis åˆ—è¡¨æ˜¯ç®€å•çš„å­—ç¬¦ä¸²åˆ—è¡¨ï¼ŒæŒ‰ç…§æ’å…¥é¡ºåºæ’åºã€‚ä½ å¯ä»¥æ·»åŠ ä¸€ä¸ªå…ƒç´ åˆ°åˆ—è¡¨çš„å¤´éƒ¨ï¼ˆå·¦è¾¹ï¼‰æˆ–è€…å°¾éƒ¨ï¼ˆå³è¾¹ï¼‰ã€‚ 1 Setï¼ˆé›†åˆï¼‰Redisçš„Setæ˜¯stringç±»å‹çš„æ— åºé›†åˆã€‚ é›†åˆæ˜¯é€šè¿‡å“ˆå¸Œè¡¨å®ç°çš„ï¼Œæ‰€ä»¥æ·»åŠ ï¼Œåˆ é™¤ï¼ŒæŸ¥æ‰¾çš„å¤æ‚åº¦éƒ½æ˜¯O(1)ã€‚ 1","link":"/2022/01/08/%E6%B6%88%E8%B4%B9Kafka%E5%90%8C%E6%AD%A5%E5%88%B0Hologres-%E4%B8%89/"},{"title":"æ¶ˆè´¹KafkaåŒæ­¥åˆ°Hologres(äºŒ)","text":"ä¸Šä¸€ç¯‡æ–‡ç« è®²äº†å¦‚ä½•ç”¨Pythonæ¶ˆè´¹Kafkaã€‚ä½†å¦‚æœKafkaç”Ÿäº§é€Ÿåº¦å¤ªå¿«ï¼Œè€Œå®¢æˆ·ç«¯æ¶ˆè´¹é€Ÿåº¦è·Ÿä¸ä¸Šçš„è¯ï¼Œå°±éœ€è¦è€ƒè™‘å¹¶å‘æ¶ˆè´¹ã€‚ å¤šè¿›ç¨‹æ¶ˆè´¹ä¸šåŠ¡ä¸­Kafkaçš„topicæœ‰12ä¸ªåˆ†åŒºï¼ŒQPS4000+ï¼ŒHologres I/Oæ¶ˆè´¹é€Ÿåº¦è¿˜æ˜¯è·Ÿä¸ä¸Šã€‚ 123456import multiprocessingfrom multiprocessing import Processfor i in range(12): p = Process(target=threadTask, name='è¿›ç¨‹%d' % i) p.start() åç¨‹æ¶ˆè´¹æ¯ä¸ªè¿›ç¨‹è°ƒç”¨åç¨‹æ¶ˆè´¹ã€‚åç¨‹æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªçº¿ç¨‹ï¼Œä»¥å‰çº¿ç¨‹ä»»åŠ¡çš„åˆ‡æ¢æ˜¯ç”±æ“ä½œç³»ç»Ÿæ§åˆ¶çš„ï¼Œé‡åˆ°I/Oè‡ªåŠ¨åˆ‡æ¢ï¼Œç°åœ¨æˆ‘ä»¬ç”¨åç¨‹çš„ç›®çš„å°±æ˜¯è¾ƒå°‘æ“ä½œç³»ç»Ÿåˆ‡æ¢çš„å¼€é”€ï¼ˆå¼€å…³çº¿ç¨‹ï¼Œåˆ›å»ºå¯„å­˜å™¨ã€å †æ ˆç­‰ï¼Œåœ¨ä»–ä»¬ä¹‹é—´è¿›è¡Œåˆ‡æ¢ç­‰ï¼‰ï¼Œåœ¨æˆ‘ä»¬è‡ªå·±çš„ç¨‹åºé‡Œé¢æ¥æ§åˆ¶ä»»åŠ¡çš„åˆ‡æ¢ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374'''1ã€åç¨‹ï¼š å•çº¿ç¨‹å®ç°å¹¶å‘ åœ¨åº”ç”¨ç¨‹åºé‡Œæ§åˆ¶å¤šä¸ªä»»åŠ¡çš„åˆ‡æ¢+ä¿å­˜çŠ¶æ€ ä¼˜ç‚¹ï¼š åº”ç”¨ç¨‹åºçº§åˆ«é€Ÿåº¦è¦è¿œè¿œé«˜äºæ“ä½œç³»ç»Ÿçš„åˆ‡æ¢ ç¼ºç‚¹ï¼š - æ¯ä¸ªåç¨‹ä»»åŠ¡éƒ½ä¼šå ç”¨ä¸€ä¸ªè¿æ¥æ•°ï¼Œå¦‚æœç”Ÿäº§é€Ÿåº¦è¿‡å¿«ï¼Œè¿æ¥æ•°ä¼šä¸€ç›´å¢åŠ ã€‚ - å¤šä¸ªä»»åŠ¡ä¸€æ—¦æœ‰ä¸€ä¸ªé˜»å¡æ²¡æœ‰åˆ‡ï¼Œæ•´ä¸ªçº¿ç¨‹éƒ½é˜»å¡åœ¨åŸåœ° è¯¥çº¿ç¨‹å†…çš„å…¶ä»–çš„ä»»åŠ¡éƒ½ä¸èƒ½æ‰§è¡Œäº† ä¸€æ—¦å¼•å…¥åç¨‹ï¼Œå°±éœ€è¦æ£€æµ‹å•çº¿ç¨‹ä¸‹æ‰€æœ‰çš„IOè¡Œä¸º, å®ç°é‡åˆ°IOå°±åˆ‡æ¢,å°‘ä¸€ä¸ªéƒ½ä¸è¡Œï¼Œä»¥ä¸ºä¸€æ—¦ä¸€ä¸ªä»»åŠ¡é˜»å¡äº†ï¼Œæ•´ä¸ªçº¿ç¨‹å°±é˜»å¡äº†ï¼Œ å…¶ä»–çš„ä»»åŠ¡å³ä¾¿æ˜¯å¯ä»¥è®¡ç®—ï¼Œä½†æ˜¯ä¹Ÿæ— æ³•è¿è¡Œäº†2ã€åç¨‹åºçš„ç›®çš„ï¼š æƒ³è¦åœ¨å•çº¿ç¨‹ä¸‹å®ç°å¹¶å‘ å¹¶å‘æŒ‡çš„æ˜¯å¤šä¸ªä»»åŠ¡çœ‹èµ·æ¥æ˜¯åŒæ—¶è¿è¡Œçš„ å¹¶å‘=åˆ‡æ¢+ä¿å­˜çŠ¶æ€'''import timeimport asyncioimport queueimport threadingimport uuidimport random'''åŸºäºåç¨‹çš„æ¶ˆè´¹è€…æ¨¡å‹ï¼Œå¤šä¸ªåç¨‹å……å½“workeræ¶ˆè´¹æ¶ˆæ¯ã€‚'''now = lambda : time.time()async def customer(num,q): print('ä»»åŠ¡ %dï¼šstart worker...' % num) while True: try: start = now() task = q.get(block=False) print('ä»»åŠ¡ %dï¼šcustomer %s' % (num, task)) await asyncio.sleep(10) # å‡è®¾æ¯ä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹æ¶ˆæ¯éœ€è¦10ç§’ï¼Œè¿™æ ·å¯ä»¥çœ‹å‡ºç”Ÿäº§è€…ç”Ÿæˆçš„æ¶ˆæ¯è¢«ä¸åŒçš„æ¶ˆè´¹è€…æ¶ˆè´¹ except Exception as e: await asyncio.sleep(1) continueasync def run_async_customer(q): tasks = [] for num in range(3): tasks.append(asyncio.create_task(customer(num,q))) await asyncio.gather(*tasks)def product(q): print('product start...') while True: pro = 'äº§å“ %s' % str(uuid.uuid1()) print(pro) q.put(pro) time.sleep(random.randint(2,4))def run(q): asyncio.run(run_async_customer(q))if __name__ == '__main__': q = queue.Queue() # å¼€å¯ä¸€ä¸ªçº¿ç¨‹è¿è¡Œç”Ÿäº§è€… prod = threading.Thread(target=product, args=(q,)) # å¼€å¯ä¸€ä¸ªçº¿ç¨‹è¿è¡Œæ‰€æœ‰çš„æ¶ˆè´¹è€… cust = threading.Thread(target=run, args=(q,)) prod.start() cust.start() prod.join() cust.join()","link":"/2022/01/08/%E6%B6%88%E8%B4%B9Kafka%E5%90%8C%E6%AD%A5%E5%88%B0Hologres-%E4%BA%8C/"},{"title":"æ¶ˆè´¹KafkaåŒæ­¥åˆ°Hologres(å››)","text":"æ•°æ®æµå‘çº¿ç¨‹ä¸€æ¶ˆè´¹Kafka topic_01æ¶ˆæ¯ï¼Œæ•´ç†è®¡ç®—åå­˜å…¥Redisï¼Œå¹¶å†™å…¥å…¨å±€å…±äº«é˜Ÿåˆ—ã€‚ çº¿ç¨‹äºŒè¯»å–é˜Ÿåˆ—ä¸­çš„æ•°æ®å†™å…¥Kafka topic_02ã€‚ é€šè¿‡é›†æˆèµ„æºç»„åŒæ­¥Kafka topic_02åˆ°Hologresã€‚ è·¨æ¨¡å—å…¨å±€å˜é‡ç®¡ç†123456789101112131415161718192021222324252627import queue# Queuedef init(): global _global_queue _global_queue = queue.Queue(maxsize=0)def put(value): _global_queue.put(value)def get(defValue=None): try: return _global_queue.get() except: return defValuedef getSize(): return _global_queue.qsize()def taskDone(): _global_queue.task_done() KafkaProducer1234567891011121314151617181920212223import golfrom kafka import KafkaProducerfrom kafka.errors import KafkaErrordef kafkaProducer(): confKafka = setting.kafkaSetting producer = KafkaProducer(bootstrap_servers=confKafka['bootstrap_servers'], api_version=(0, 10), retries=5) while True: data = gol.get() if data is None: continue gol.taskDone() key = (str(importData['uid']) + str(importData['itemId'])).encode() value = json.dumps(data).encode() try: future = producer.send(confKafka['topic_name'], key=key, value=value) future.get() except KafkaError as e: print(e)","link":"/2022/01/08/%E6%B6%88%E8%B4%B9Kafka%E5%90%8C%E6%AD%A5%E5%88%B0Hologres-%E5%9B%9B/"}],"tags":[{"name":"Kafka","slug":"Kafka","link":"/tags/Kafka/"},{"name":"Python","slug":"Python","link":"/tags/Python/"},{"name":"Linux","slug":"Linux","link":"/tags/Linux/"},{"name":"Mysql","slug":"Mysql","link":"/tags/Mysql/"},{"name":"Ocr","slug":"Ocr","link":"/tags/Ocr/"},{"name":"PostgreSql","slug":"PostgreSql","link":"/tags/PostgreSql/"},{"name":"Algorithm","slug":"Algorithm","link":"/tags/Algorithm/"},{"name":"Redis","slug":"Redis","link":"/tags/Redis/"},{"name":"Hologres","slug":"Hologres","link":"/tags/Hologres/"}],"categories":[{"name":"ç¬”è®°","slug":"ç¬”è®°","link":"/categories/%E7%AC%94%E8%AE%B0/"},{"name":"å·¥ä½œ","slug":"å·¥ä½œ","link":"/categories/%E5%B7%A5%E4%BD%9C/"}]}